<!DOCTYPE html>
<html>
<head> <title>Collective Variables Module - Colvars Module - Reference Manual</title>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" name="generator"/>
<link href="colvars-refman-lammps.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style>
</head><body>
<!--l. 135--><p class="noindent"></p><div id="container"> <div class="inner">
<!--l. 138--><p class="indent">
</p><!--l. 140--><p class="noindent"><span class="colorbox" id="colorbox1"> </span></p><div class="minipage"><!--l. 179--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mspace class="thinspace" width="0.17em"></mspace></math><br class="newline"/>
<!--l. 179--><p class="noindent"><span class="phvb8t-x-x-248">COLLECTIVE VARIABLES MODULE</span><br class="newline"/>
</p><!--l. 179--><p class="noindent"><span class="phvb8t-x-x-248">Reference manual for LAMMPS</span><br class="newline"/>
</p><!--l. 179--><p class="noindent"><br class="newline"/>Code version: 2025-08-27<br class="newline"/>
</p><!--l. 179--><p class="noindent">Updated versions of this manual: [<a href="https://colvars.github.io/master/colvars-refman-gromacs.html">GROMACS</a>] [<a href="https://colvars.github.io/master/colvars-refman-lammps.html">LAMMPS</a>] [<a href="https://colvars.github.io/master/colvars-refman-namd.html">NAMD</a>] [<a href="https://colvars.github.io/master/colvars-refman-tinkerhp.html">Tinker-HP</a>] [<a href="https://colvars.github.io/master/colvars-refman-vmd.html">VMD</a>]</p></div>
<!--l. 183--><p class="indent"> <img alt="Colvars logo" class="cover_picture" src="cover-512px.jpg"/> <br class="newline"/><span class="phvr8t-x-x-120">Alejandro Bernardin, Haochuan Chen, Jeffrey R. Comer, Giacomo Fiorin, Haohao Fu, J</span><span class="phvr8t-x-x-120">é</span><span class="phvr8t-x-x-120">r</span><span class="phvr8t-x-x-120">ô</span><span class="phvr8t-x-x-120">me</span>
<span class="phvr8t-x-x-120">H</span><span class="phvr8t-x-x-120">é</span><span class="phvr8t-x-x-120">nin, Axel Kohlmeyer, Fabrizio Marinelli, Hubert Santuz, Joshua V. Vermaas, Andrew D.</span>
<span class="phvr8t-x-x-120">White, Wei Zhang</span>
</p><!--l. 191--><p class="noindent">(<a href="https://colvars.github.io/master/colvars-refman-lammps.pdf">PDF version</a>)
                                                                                         
                                                                                         
</p><!--l. 202--><p class="indent">
<a id="sec:toc"></a>
</p><!--l. 204--><p class="indent">
</p>
<h3 class="likesectionHead"><a id="x1-1000"></a>Contents</h3>
<div class="tableofcontents">
    <span class="sectionToc">1 <a href="#sec:colvars_intro" id="QQ2-1-2">Overview</a></span>
<br/>    <span class="sectionToc">2 <a href="#sec:colvars_crash_course" id="QQ2-1-3">Writing a Colvars configuration: a crash course</a></span>
<br/>    <span class="sectionToc">3 <a href="#sec:colvarmodule" id="QQ2-1-6">Enabling and controlling the Colvars module in LAMMPS</a></span>
<br/>     <span class="subsectionToc">3.1 <a href="#sec:units" id="QQ2-1-7">Units in the Colvars module</a></span>
<br/>     <span class="subsectionToc">3.2 <a href="#sec:colvars_mdengine_parameters" id="QQ2-1-8">LAMMPS keywords</a></span>
<br/>     <span class="subsectionToc">3.3 <a href="#sec:cv_scripting" id="QQ2-1-9">Using the scripting interface to control the Colvars module</a></span>
<br/>      <span class="subsubsectionToc">3.3.1 <a href="#sec:cv_command_init" id="QQ2-1-10">Setting up the Colvars module</a></span>
<br/>      <span class="subsubsectionToc">3.3.2 <a href="#sec:cv_command_loadsave" id="QQ2-1-11">Loading and saving the Colvars state and other information</a></span>
<br/>      <span class="subsubsectionToc">3.3.3 <a href="#sec:cv_command_atomic_data" id="QQ2-1-12">Accessing atomic data</a></span>
<br/>      <span class="subsubsectionToc">3.3.4 <a href="#sec:cv_command_colvar" id="QQ2-1-13">Managing collective variables</a></span>
<br/>      <span class="subsubsectionToc">3.3.5 <a href="#sec:cv_command_colvar_force" id="QQ2-1-14">Applying and analyzing forces on collective variables</a></span>
<br/>      <span class="subsubsectionToc">3.3.6 <a href="#sec:cv_command_bias" id="QQ2-1-15">Managing collective variable biases</a></span>
<br/>      <span class="subsubsectionToc">3.3.7 <a href="#sec:cv_command_bias_loadsave" id="QQ2-1-16">Loading and saving the state of individual biases</a></span>
<br/>     <span class="subsectionToc">3.4 <a href="#sec:colvars_config_syntax" id="QQ2-1-17">Configuration syntax used by the Colvars module</a></span>
<br/>     <span class="subsectionToc">3.5 <a href="#sec:colvars_global" id="QQ2-1-18">Global keywords</a></span>
<br/>     <span class="subsectionToc">3.6 <a href="#sec:colvars_input" id="QQ2-1-19">Input state file</a></span>
<br/>      <span class="subsubsectionToc">3.6.1 <a href="#" id="QQ2-1-20">Restarting in LAMMPS.</a></span>
<br/>      <span class="subsubsectionToc">3.6.2 <a href="#sec:change_config_restart" id="QQ2-1-21">Changing configuration upon restarting.</a></span>
<br/>     <span class="subsectionToc">3.7 <a href="#sec:colvars_output" id="QQ2-1-22">Output files</a></span>
<br/>     <span class="subsectionToc">3.8 <a href="#sec:colvars_file_formats" id="QQ2-1-23">File formats</a></span>
<br/>      <span class="subsubsectionToc">3.8.1 <a href="#sec:colvars_text_format" id="QQ2-1-24">Configuration and state files.</a></span>
<br/>      <span class="subsubsectionToc">3.8.2 <a href="#sec:colvars_ndx_format" id="QQ2-1-25">Index (NDX) files</a></span>
<br/>      <span class="subsubsectionToc">3.8.3 <a href="#sec:colvars_xyz_format" id="QQ2-1-26">XYZ coordinate files</a></span>
<br/>      <span class="subsubsectionToc">3.8.4 <a href="#sec:colvar_multicolumn_grid" id="QQ2-1-27">Grid files: multicolumn text format</a></span>
<br/>      <span class="subsubsectionToc">3.8.5 <a href="#sec:colvars_traj_format" id="QQ2-1-28">Output trajectory files</a></span>
<br/>    <span class="sectionToc">4 <a href="#sec:colvar" id="QQ2-1-29">Defining collective variables</a></span>
<br/>     <span class="subsectionToc">4.1 <a href="#sec:cvc_list" id="QQ2-1-30">Choosing a function</a></span>
<br/>     <span class="subsectionToc">4.2 <a href="#sec:cvc_pbcs" id="QQ2-1-31">Treatment of periodic boundary conditions</a></span>
<br/>     <span class="subsectionToc">4.3 <a href="#sec:cvc_distances" id="QQ2-1-33">Distances</a></span>
<br/>      <span class="subsubsectionToc">4.3.1 <a href="#sec:cvc_distance" id="QQ2-1-34"><span class="ectt-1095">distance</span>: center-of-mass distance between two groups.</a></span>
<br/>      <span class="subsubsectionToc">4.3.2 <a href="#x1-350004.3.2" id="QQ2-1-35"><span class="ectt-1095">distanceZ</span>: projection of a distance vector on an axis.</a></span>
<br/>      <span class="subsubsectionToc">4.3.3 <a href="#x1-360004.3.3" id="QQ2-1-36"><span class="ectt-1095">distanceXY</span>: modulus of the projection of a distance vector on a plane.</a></span>
<br/>      <span class="subsubsectionToc">4.3.4 <a href="#x1-370004.3.4" id="QQ2-1-37"><span class="ectt-1095">distanceVec</span>: distance vector between two groups.</a></span>
<br/>      <span class="subsubsectionToc">4.3.5 <a href="#x1-380004.3.5" id="QQ2-1-38"><span class="ectt-1095">distanceDir</span>: distance unit vector between two groups.</a></span>
<br/>      <span class="subsubsectionToc">4.3.6 <a href="#x1-390004.3.6" id="QQ2-1-39"><span class="ectt-1095">distanceInv</span>: mean distance between two groups of atoms.</a></span>
<br/>     <span class="subsectionToc">4.4 <a href="#x1-400004.4" id="QQ2-1-40">Angles</a></span>
<br/>      <span class="subsubsectionToc">4.4.1 <a href="#x1-410004.4.1" id="QQ2-1-41"><span class="ectt-1095">angle</span>: angle between three groups.</a></span>
<br/>      <span class="subsubsectionToc">4.4.2 <a href="#x1-420004.4.2" id="QQ2-1-42"><span class="ectt-1095">dipoleAngle</span>: angle between two groups and dipole of a third group.</a></span>
<br/>      <span class="subsubsectionToc">4.4.3 <a href="#x1-430004.4.3" id="QQ2-1-43"><span class="ectt-1095">dihedral</span>: torsional angle between four groups.</a></span>
<br/>      <span class="subsubsectionToc">4.4.4 <a href="#x1-440004.4.4" id="QQ2-1-44"><span class="ectt-1095">polarTheta</span>: polar angle in spherical coordinates.</a></span>
<br/>      <span class="subsubsectionToc">4.4.5 <a href="#x1-450004.4.5" id="QQ2-1-45"><span class="ectt-1095">polarPhi</span>: azimuthal angle in spherical coordinates.</a></span>
<br/>     <span class="subsectionToc">4.5 <a href="#x1-460004.5" id="QQ2-1-46">Contacts</a></span>
<br/>      <span class="subsubsectionToc">4.5.1 <a href="#x1-470004.5.1" id="QQ2-1-47"><span class="ectt-1095">coordNum</span>: coordination number between two groups.</a></span>
<br/>      <span class="subsubsectionToc">4.5.2 <a href="#x1-480004.5.2" id="QQ2-1-48"><span class="ectt-1095">selfCoordNum</span>: coordination number between atoms within a group.</a></span>
<br/>      <span class="subsubsectionToc">4.5.3 <a href="#x1-490004.5.3" id="QQ2-1-49"><span class="ectt-1095">hBond</span>: hydrogen bond between two atoms.</a></span>
<br/>     <span class="subsectionToc">4.6 <a href="#x1-500004.6" id="QQ2-1-50">Collective metrics</a></span>
<br/>      <span class="subsubsectionToc">4.6.1 <a href="#sec:cvc_rmsd" id="QQ2-1-51"><span class="ectt-1095">rmsd</span>: root mean square displacement (RMSD) from reference
positions.</a></span>
<br/>      <span class="subsubsectionToc">4.6.2 <a href="#x1-520004.6.2" id="QQ2-1-52">Advanced usage of the <span class="ectt-1095">rmsd </span>component.</a></span>
<br/>      <span class="subsubsectionToc">4.6.3 <a href="#x1-530004.6.3" id="QQ2-1-53"><span class="ectt-1095">eigenvector</span>: projection of the atomic coordinates on a vector.</a></span>
<br/>      <span class="subsubsectionToc">4.6.4 <a href="#x1-540004.6.4" id="QQ2-1-54"><span class="ectt-1095">gyration</span>: radius of gyration of a group of atoms.</a></span>
<br/>      <span class="subsubsectionToc">4.6.5 <a href="#x1-550004.6.5" id="QQ2-1-55"><span class="ectt-1095">inertia</span>: total moment of inertia of a group of atoms.</a></span>
<br/>      <span class="subsubsectionToc">4.6.6 <a href="#x1-560004.6.6" id="QQ2-1-56"><span class="ectt-1095">dipoleMagnitude</span>: dipole magnitude of a group of atoms.</a></span>
<br/>      <span class="subsubsectionToc">4.6.7 <a href="#x1-570004.6.7" id="QQ2-1-57"><span class="ectt-1095">inertiaZ</span>: total moment of inertia of a group of atoms around
a chosen axis.</a></span>
<br/>     <span class="subsectionToc">4.7 <a href="#x1-580004.7" id="QQ2-1-58">Rotations</a></span>
<br/>      <span class="subsubsectionToc">4.7.1 <a href="#x1-590004.7.1" id="QQ2-1-59"><span class="ectt-1095">orientation</span>: orientation from reference coordinates.</a></span>
<br/>      <span class="subsubsectionToc">4.7.2 <a href="#x1-610004.7.2" id="QQ2-1-61"><span class="ectt-1095">orientationAngle</span>: angle of rotation from reference coordinates.</a></span>
<br/>      <span class="subsubsectionToc">4.7.3 <a href="#x1-620004.7.3" id="QQ2-1-62"><span class="ectt-1095">orientationProj</span>: cosine of the angle of rotation from
reference coordinates.</a></span>
<br/>      <span class="subsubsectionToc">4.7.4 <a href="#x1-630004.7.4" id="QQ2-1-63"><span class="ectt-1095">spinAngle</span>: angle of rotation around a given axis.</a></span>
<br/>      <span class="subsubsectionToc">4.7.5 <a href="#x1-640004.7.5" id="QQ2-1-64"><span class="ectt-1095">tilt</span>: cosine of the rotation orthogonal to a given axis.</a></span>
<br/>      <span class="subsubsectionToc">4.7.6 <a href="#x1-650004.7.6" id="QQ2-1-65"><span class="ectt-1095">eulerPhi</span>: Roll angle from references coordinates.</a></span>
<br/>      <span class="subsubsectionToc">4.7.7 <a href="#x1-660004.7.7" id="QQ2-1-66"><span class="ectt-1095">eulerTheta</span>: Pitch angle from references coordinates.</a></span>
<br/>      <span class="subsubsectionToc">4.7.8 <a href="#x1-670004.7.8" id="QQ2-1-67"><span class="ectt-1095">eulerPsi</span>: Yaw angle from references coordinates.</a></span>
<br/>     <span class="subsectionToc">4.8 <a href="#x1-680004.8" id="QQ2-1-68">Protein structure descriptors</a></span>
<br/>      <span class="subsubsectionToc">4.8.1                                                                              <a href="#x1-690004.8.1" id="QQ2-1-69"><span class="ectt-1095">alpha</span>:
<!--l. 70--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math>-helix
content of a protein segment.</a></span>
<br/>      <span class="subsubsectionToc">4.8.2 <a href="#x1-700004.8.2" id="QQ2-1-70"><span class="ectt-1095">dihedralPC</span>: protein dihedral principal component</a></span>
<br/>     <span class="subsectionToc">4.9 <a href="#x1-710004.9" id="QQ2-1-71">Raw data: building blocks for custom functions</a></span>
<br/>      <span class="subsubsectionToc">4.9.1 <a href="#sec:cvc_cartesian" id="QQ2-1-72"><span class="ectt-1095">cartesian</span>: vector of atomic Cartesian coordinates.</a></span>
<br/>      <span class="subsubsectionToc">4.9.2 <a href="#x1-730004.9.2" id="QQ2-1-73"><span class="ectt-1095">distancePairs</span>: set of pairwise distances between two groups.</a></span>
<br/>     <span class="subsectionToc">4.10 <a href="#x1-740004.10" id="QQ2-1-74">Geometric path collective variables</a></span>
<br/>      <span class="subsubsectionToc">4.10.1 <a href="#x1-750004.10.1" id="QQ2-1-75"><span class="ectt-1095">gspath</span>: progress along a path defined in atomic Cartesian
coordinate space.</a></span>
<br/>      <span class="subsubsectionToc">4.10.2 <a href="#x1-760004.10.2" id="QQ2-1-76"><span class="ectt-1095">gzpath</span>: distance from a path defined in atomic Cartesian
coordinate space.</a></span>
<br/>      <span class="subsubsectionToc">4.10.3 <a href="#x1-770004.10.3" id="QQ2-1-77"><span class="ectt-1095">linearCombination</span>: Helper CV to define a linear combination
of other CVs</a></span>
<br/>      <span class="subsubsectionToc">4.10.4 <a href="#x1-780004.10.4" id="QQ2-1-78"><span class="ectt-1095">customColvar</span>: Helper CV to define a mathematical expression
as CV from other CVs</a></span>
<br/>      <span class="subsubsectionToc">4.10.5 <a href="#x1-790004.10.5" id="QQ2-1-79"><span class="ectt-1095">gspathCV</span>: progress along a path defined in CV space.</a></span>
<br/>      <span class="subsubsectionToc">4.10.6 <a href="#x1-800004.10.6" id="QQ2-1-80"><span class="ectt-1095">gzpathCV</span>: distance from a path defined in CV space.</a></span>
<br/>     <span class="subsectionToc">4.11 <a href="#x1-810004.11" id="QQ2-1-81">Arithmetic path collective variables</a></span>
<br/>      <span class="subsubsectionToc">4.11.1 <a href="#x1-820004.11.1" id="QQ2-1-82"><span class="ectt-1095">aspathCV</span>: progress along a path defined in CV space.</a></span>
<br/>      <span class="subsubsectionToc">4.11.2 <a href="#x1-830004.11.2" id="QQ2-1-83"><span class="ectt-1095">azpathCV</span>: distance from a path defined in CV space.</a></span>
<br/>      <span class="subsubsectionToc">4.11.3 <a href="#x1-840004.11.3" id="QQ2-1-84"><span class="ectt-1095">aspath</span>: progress along a path defined in atomic Cartesian
coordinate space.</a></span>
<br/>      <span class="subsubsectionToc">4.11.4 <a href="#x1-850004.11.4" id="QQ2-1-85"><span class="ectt-1095">azpath</span>: distance from a path defined in atomic Cartesian
coordinate space.</a></span>
<br/>     <span class="subsectionToc">4.12 <a href="#x1-860004.12" id="QQ2-1-86">Dense neural network in CV space (MLCV)</a></span>
<br/>     <span class="subsectionToc">4.13 <a href="#x1-870004.13" id="QQ2-1-88">Torch-based collective variables</a></span>
<br/>     <span class="subsectionToc">4.14 <a href="#sec:cvc_common" id="QQ2-1-89">Shared keywords for all components</a></span>
<br/>     <span class="subsectionToc">4.15 <a href="#x1-890004.15" id="QQ2-1-90">Periodic components</a></span>
<br/>     <span class="subsectionToc">4.16 <a href="#x1-900004.16" id="QQ2-1-91">Non-scalar components</a></span>
<br/>      <span class="subsubsectionToc">4.16.1 <a href="#x1-910004.16.1" id="QQ2-1-92">Calculating total forces</a></span>
<br/>     <span class="subsectionToc">4.17 <a href="#sec:cvc_superp" id="QQ2-1-93">Linear and polynomial combinations of components</a></span>
<br/>     <span class="subsectionToc">4.18 <a href="#sec:colvar_custom_function" id="QQ2-1-94">Custom functions</a></span>
<br/>     <span class="subsectionToc">4.19 <a href="#x1-940004.19" id="QQ2-1-95">Defining grid parameters for a colvar</a></span>
<br/>     <span class="subsectionToc">4.20 <a href="#x1-950004.20" id="QQ2-1-96">Trajectory output</a></span>
<br/>     <span class="subsectionToc">4.21 <a href="#sec:colvar_extended" id="QQ2-1-97">Extended Lagrangian</a></span>
<br/>     <span class="subsectionToc">4.22 <a href="#x1-970004.22" id="QQ2-1-98">Multiple time-step variables</a></span>
<br/>     <span class="subsectionToc">4.23 <a href="#x1-980004.23" id="QQ2-1-99">Backward-compatibility</a></span>
<br/>     <span class="subsectionToc">4.24 <a href="#x1-990004.24" id="QQ2-1-100">Statistical analysis</a></span>
<br/>    <span class="sectionToc">5 <a href="#sec:colvar_atom_groups" id="QQ2-1-101">Selecting atoms</a></span>
<br/>     <span class="subsectionToc">5.1 <a href="#x1-1010005.1" id="QQ2-1-102">Atom selection keywords</a></span>
<br/>     <span class="subsectionToc">5.2 <a href="#x1-1020005.2" id="QQ2-1-103">Moving frame of reference.</a></span>
<br/>     <span class="subsectionToc">5.3 <a href="#sec:colvar_atom_groups_wrapping" id="QQ2-1-106">Treatment of periodic boundary conditions.</a></span>
<br/>     <span class="subsectionToc">5.4 <a href="#x1-1060005.4" id="QQ2-1-107">Performance of a Colvars calculation based on group size.</a></span>
<br/>    <span class="sectionToc">6 <a href="#sec:colvarbias" id="QQ2-1-108">Biasing and analysis methods</a></span>
<br/>     <span class="subsectionToc">6.1 <a href="#x1-1080006.1" id="QQ2-1-109">Defining grids for biasing and analysis methods</a></span>
<br/>     <span class="subsectionToc">6.2 <a href="#sec:colvarbias_ti" id="QQ2-1-110">Thermodynamic integration</a></span>
<br/>     <span class="subsectionToc">6.3 <a href="#sec:colvarbias_abf" id="QQ2-1-111">Adaptive Biasing Force</a></span>
<br/>      <span class="subsubsectionToc">6.3.1 <a href="#x1-1110006.3.1" id="QQ2-1-112">ABF requirements on collective variables</a></span>
<br/>      <span class="subsubsectionToc">6.3.2 <a href="#x1-1120006.3.2" id="QQ2-1-113">Parameters for ABF</a></span>
<br/>      <span class="subsubsectionToc">6.3.3 <a href="#x1-1130006.3.3" id="QQ2-1-114">Multiple-walker ABF</a></span>
<br/>      <span class="paragraphToc"><a href="#x1-1140006.3.3" id="QQ2-1-115">Output files of multiple-walker ABF.</a></span>
<br/>      <span class="subsubsectionToc">6.3.4 <a href="#x1-1150006.3.4" id="QQ2-1-116">Output files</a></span>
<br/>      <span class="subsubsectionToc">6.3.5 <a href="#x1-1160006.3.5" id="QQ2-1-117">Multidimensional free energy surfaces</a></span>
<br/>     <span class="subsectionToc">6.4 <a href="#x1-1170006.4" id="QQ2-1-118">Extended-system Adaptive Biasing Force (eABF)</a></span>
<br/>      <span class="subsubsectionToc">6.4.1 <a href="#x1-1180006.4.1" id="QQ2-1-119">CZAR estimator of the free energy</a></span>
<br/>     <span class="subsectionToc">6.5 <a href="#x1-1190006.5" id="QQ2-1-120">Adiabatic Bias Molecular Dynamics (ABMD)</a></span>
<br/>     <span class="subsectionToc">6.6 <a href="#sec:colvarbias_meta" id="QQ2-1-121">Metadynamics</a></span>
<br/>      <span class="subsubsectionToc">6.6.1 <a href="#x1-1210006.6.1" id="QQ2-1-122">Treatment of the PMF boundaries</a></span>
<br/>      <span class="subsubsectionToc">6.6.2 <a href="#x1-1220006.6.2" id="QQ2-1-123">Required metadynamics keywords</a></span>
<br/>      <span class="subsubsectionToc">6.6.3 <a href="#x1-1230006.6.3" id="QQ2-1-124">Output files</a></span>
<br/>      <span class="subsubsectionToc">6.6.4 <a href="#x1-1240006.6.4" id="QQ2-1-125">Performance optimization</a></span>
<br/>      <span class="subsubsectionToc">6.6.5 <a href="#sec:colvarbias_ebmeta" id="QQ2-1-126">Ensemble-Biased Metadynamics</a></span>
<br/>      <span class="subsubsectionToc">6.6.6 <a href="#x1-1260006.6.6" id="QQ2-1-127">Well-tempered metadynamics</a></span>
<br/>      <span class="subsubsectionToc">6.6.7 <a href="#sec:colvarbias_meta_mr" id="QQ2-1-128">Multiple-walker metadynamics</a></span>
<br/>     <span class="subsectionToc">6.7 <a href="#x1-1280006.7" id="QQ2-1-129">On-the-fly probability enhanced sampling (OPES)</a></span>
<br/>      <span class="subsubsectionToc">6.7.1 <a href="#x1-1290006.7.1" id="QQ2-1-130">Implementation notes</a></span>
<br/>      <span class="subsubsectionToc">6.7.2 <a href="#x1-1300006.7.2" id="QQ2-1-131">General options</a></span>
<br/>      <span class="subsubsectionToc">6.7.3 <a href="#x1-1310006.7.3" id="QQ2-1-132">Multiple-walker options</a></span>
<br/>      <span class="subsubsectionToc">6.7.4 <a href="#x1-1320006.7.4" id="QQ2-1-133">Output options</a></span>
<br/>      <span class="subsubsectionToc">6.7.5 <a href="#x1-1330006.7.5" id="QQ2-1-134">Example input</a></span>
<br/>     <span class="subsectionToc">6.8 <a href="#sec:colvarbias_harmonic" id="QQ2-1-135">Harmonic restraints</a></span>
<br/>      <span class="subsubsectionToc">6.8.1 <a href="#x1-1350006.8.1" id="QQ2-1-136">Moving restraints: steered molecular dynamics</a></span>
<br/>      <span class="subsubsectionToc">6.8.2 <a href="#x1-1360006.8.2" id="QQ2-1-137">Moving restraints: umbrella sampling</a></span>
<br/>      <span class="subsubsectionToc">6.8.3 <a href="#x1-1370006.8.3" id="QQ2-1-138">Changing force constant</a></span>
<br/>     <span class="subsectionToc">6.9 <a href="#x1-1380006.9" id="QQ2-1-139">Computing the work of a changing restraint</a></span>
<br/>     <span class="subsectionToc">6.10 <a href="#x1-1390006.10" id="QQ2-1-140">Harmonic wall restraints</a></span>
<br/>     <span class="subsectionToc">6.11 <a href="#x1-1400006.11" id="QQ2-1-141">Linear restraints</a></span>
<br/>     <span class="subsectionToc">6.12 <a href="#x1-1410006.12" id="QQ2-1-142">Adaptive Linear Bias/Experiment Directed Simulation</a></span>
<br/>     <span class="subsectionToc">6.13 <a href="#sec:colvarbias_histogram" id="QQ2-1-143">Multidimensional histograms</a></span>
<br/>      <span class="subsubsectionToc">6.13.1 <a href="#x1-1430006.13.1" id="QQ2-1-144">Output options for multi-dimensional histograms</a></span>
<br/>      <span class="subsubsectionToc">6.13.2 <a href="#x1-1440006.13.2" id="QQ2-1-145">Histogramming vector variables</a></span>
<br/>     <span class="subsectionToc">6.14 <a href="#x1-1450006.14" id="QQ2-1-146">Probability distribution-restraints</a></span>
<br/>    <span class="sectionToc">7 <a href="#sec:cvscript_cmdline" id="QQ2-1-147"><span class="ectt-1095">fix_modify </span>command-line interface: list of commands</a></span>
<br/>     <span class="subsectionToc">7.1 <a href="#sec:cvscript_cmdline_cv" id="QQ2-1-148">Commands to manage the Colvars module</a></span>
<br/>     <span class="subsectionToc">7.2 <a href="#sec:cvscript_cmdline_colvar" id="QQ2-1-149">Commands to manage individual collective variables</a></span>
<br/>     <span class="subsectionToc">7.3 <a href="#sec:cvscript_cmdline_bias" id="QQ2-1-150">Commands to manage individual biases</a></span>
<br/>    <span class="sectionToc">8 <a href="#x1-1500008" id="QQ2-1-151">Syntax changes from older versions</a></span>
<br/>    <span class="sectionToc">9 <a href="#x1-1510009" id="QQ2-1-152">Compilation notes</a></span>
</div>
<!--l. 9--><p class="indent">
</p>
<div class="flushright">
<!--l. 9--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 9--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_intro"></a>
<h3 class="sectionHead"><span class="titlemark">1    </span> <a id="sec:colvars_intro"></a>Overview</h3>
<!--l. 9--><p class="noindent"></p></div>
<!--l. 12--><p class="indent">   In molecular dynamics simulations, it is often useful to reduce the large number of degrees of freedom
of a physical system into few parameters whose statistical distributions can be analyzed individually, or
used to define biasing potentials to alter the dynamics of the system in a controlled manner. These have
been called ‘order parameters', ‘collective variables', ‘(surrogate) reaction coordinates', and many other
terms.
</p><!--l. 15--><p class="indent">   Here we use primarily the term ‘collective variable', often shortened to
<span class="phvro8t-x-x-109">colvar</span>, to indicate any differentiable function of atomic Cartesian coordinates,
<!--l. 15--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mstyle class="mbox"><mtext></mtext><mstyle class="math"><mi>x</mi></mstyle><mtext></mtext></mstyle></mrow><mrow><mi>i</mi></mrow></msub></math>, with
<!--l. 15--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math> between
<!--l. 15--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math> and
<!--l. 15--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>, the
total number of atoms: </p><table class="equation"><tr><td> <a id="x1-2001r1"></a>
<!--l. 17--><math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mi>ξ</mi><mo class="MathClass-open">(</mo><mi>t</mi><mo class="MathClass-close">)</mo><mspace class="thickpace" width="0.28em"></mspace> <mo class="MathClass-rel">=</mo> <mi>ξ</mi><mo class="MathClass-open">(</mo><mstyle class="mbox"><mtext></mtext><mstyle class="math"><mi>X</mi></mstyle><mtext></mtext></mstyle><mo class="MathClass-open">(</mo><mi>t</mi><mo class="MathClass-close">)</mo><mo class="MathClass-close">)</mo><mspace class="thickpace" width="0.28em"></mspace> <mo class="MathClass-rel">=</mo> <mi>ξ</mi> <mrow><mo fence="true" form="prefix"> (</mo><mrow><msub><mrow><mstyle class="mbox"><mtext></mtext><mstyle class="math"><mi>x</mi></mstyle><mtext></mtext></mstyle></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-open">(</mo><mi>t</mi><mo class="MathClass-close">)</mo><mo class="MathClass-punc">,</mo><msub><mrow><mstyle class="mbox"><mtext></mtext><mstyle class="math"><mi>x</mi></mstyle><mtext></mtext></mstyle></mrow><mrow><mi>j</mi></mrow></msub><mo class="MathClass-open">(</mo><mi>t</mi><mo class="MathClass-close">)</mo><mo class="MathClass-punc">,</mo><msub><mrow><mstyle class="mbox"><mtext></mtext><mstyle class="math"><mi>x</mi></mstyle><mtext></mtext></mstyle></mrow><mrow><mi>k</mi></mrow></msub><mo class="MathClass-open">(</mo><mi>t</mi><mo class="MathClass-close">)</mo><mo class="MathClass-punc">,</mo><mi class="MathClass-op">…</mi><mo> &amp;ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow><mo fence="true" form="postfix">)</mo></mrow><mspace class="thickpace" width="0.28em"></mspace><mo class="MathClass-punc">,</mo><mspace class="thickpace" width="0.28em"></mspace><mspace class="thickpace" width="0.28em"></mspace><mn>1</mn> <mo class="MathClass-rel">≤</mo> <mi>i</mi><mo class="MathClass-punc">,</mo><mi>j</mi><mo class="MathClass-punc">,</mo><mi>k</mi><mi class="MathClass-op">…</mi><mo> &amp;ApplyFunction;<!--FUNCTION APPLICATION--></mo> <mo class="MathClass-rel">≤</mo> <mi>N</mi>
</math></td><td class="eq-no">(1)</td></tr></table>
<!--l. 22--><p class="indent">   This manual documents the collective variables module (<span class="phvb8t-x-x-109">Colvars</span>), a software that provides an implementation
for the functions <!--l. 22--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ξ</mi><mo class="MathClass-open">(</mo><mstyle class="mbox"><mtext></mtext><mstyle class="math"><mi>X</mi></mstyle><mtext></mtext></mstyle><mo class="MathClass-close">)</mo></math>
with a focus on flexibility, robustness and high performance. The module is designed to perform multiple
tasks concurrently during or after a simulation, the most common of which are: </p>
<ul class="itemize1">
<li class="itemize">apply restraints or biasing potentials to multiple variables, tailored on the system by choosing
     from a wide set of basis functions, without limitations on their number or on the number of
     atoms involved;
     </li>
<li class="itemize">calculate  potentials  of  mean  force  (PMFs)  along  any  set  of  variables,  using  different
     enhanced sampling methods, such as Adaptive Biasing Force (ABF), metadynamics, steered
                                                                                         
                                                                                         
     MD and umbrella sampling; variants of these methods that make use of an ensemble of
     replicas are supported as well;
     </li>
<li class="itemize">calculate  statistical  properties  of  the  variables,  such  as  running  averages  and  standard
     deviations, correlation functions of pairs of variables, and multidimensional histograms: this
     can be done either at run-time without the need to save very large trajectory files, or after a
     simulation has been completed (post-processing).
     </li></ul>
<!--l. 36--><p class="indent">   Detailed explanations of the design of the Colvars module are provided in reference <span class="cite">[<a href="#XFiorin2013">1</a>]</span>. Please cite
this reference whenever publishing work that makes use of this module, alongside any other publications
for specific features being, according to the usage summary printed when running a Colvars-enabled MD
simulation or analysis.
</p><!--l. 48--><p class="indent">
</p>
<div class="flushright">
<!--l. 48--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 48--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_crash_course"></a>
<h3 class="sectionHead"><span class="titlemark">2    </span> <a id="sec:colvars_crash_course"></a>Writing a Colvars configuration: a crash course</h3>
<!--l. 48--><p class="noindent"></p></div>
<!--l. 50--><p class="indent">   The Colvars configuration is a plain text file or string that defines collective variables, biases, and
general parameters of the Colvars module. It is passed to the module using back-end-specific commands
documented in section <a href="#sec:colvarmodule">3<!--tex4ht:ref: sec:colvarmodule --></a>.
</p>
<!--l. 56--><p class="noindent"><span class="likeparagraphHead"><a id="x1-40002"></a>Example: steering two groups of atoms away from each other.</span>
   Now let us look at a complete, non-trivial configuration. Suppose that we want to run a steered MD
experiment where a small molecule is pulled away from a protein binding site. In Colvars terms, this is
done by applying a moving restraint to the distance between the two objects. The configuration will
contain two blocks, one defining the distance variable (see section <a href="#sec:colvar">4<!--tex4ht:ref: sec:colvar --></a> and <a href="#sec:cvc_distance">4.3.1<!--tex4ht:ref: sec:cvc_distance --></a>), and the other the moving
harmonic restraint (<a href="#sec:colvarbias_harmonic">6.8<!--tex4ht:ref: sec:colvarbias_harmonic --></a>).</p>
<div class="mdframed" id="mdframed-1">
<!--l. 64--><p class="noindent"></p><pre>
<!--l. 66--><p class="noindent">indexFile index.ndx<br class="newline"/>colvar {<br class="newline"/>  name dist<br class="newline"/>  distance {<br class="newline"/>    group1 { atomNumbersRange 42-55 }<br class="newline"/>    group2 { indexGroup C-alpha_15-30 }<br class="newline"/>  }<br class="newline"/>}<br class="newline"/><br class="newline"/>harmonic {<br class="newline"/>  colvars dist<br class="newline"/>  forceConstant 20.0<br class="newline"/>  centers 4.0         # initial distance<br class="newline"/>  targetCenters 15.0  # final distance<br class="newline"/>  targetNumSteps 500000<br class="newline"/>} </p></pre><!--l. 81--><p class="noindent"></p>
</div>
<!--l. 83--><p class="indent">   Reading this input in plain English: the variable here named <span class="phvro8t-x-x-109">dist </span>consists in a distance
function between the centers of two groups: the ligand (atoms 42 to 55) and the
<!--l. 83--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math>-carbon
atoms of residues 15 to 30 in the protein (selected from the index group “<span class="ectt-1095">C-alpha_15-30</span>"). To
                                                                                         
                                                                                         
the “<span class="phvro8t-x-x-109">dist</span>" variable, we apply a <span class="ectt-1095">harmonic </span>potential of force constant 20 <span class="phvro8t-x-x-109">energy unit</span>/<span class="phvro8t-x-x-109">length</span>
<span class="phvro8t-x-x-109">unit</span><!--l. 84--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow></mrow><mrow><mn>2</mn></mrow></msup></math>,
initially centered around a value of 4 <span class="phvro8t-x-x-109">length unit</span>, which will increase to 15 <span class="phvro8t-x-x-109">length unit </span>over 500,000
simulation steps.
</p><!--l. 86--><p class="indent">   The atom selection keywords are detailed in section <a href="#sec:colvar_atom_groups">5<!--tex4ht:ref: sec:colvar_atom_groups --></a>. If the selection is too complex to implement
only via internal keywords, an external index file may be created following the NDX format used in
GROMACS (see <a href="#sec:colvars_ndx_format">3.8.2<!--tex4ht:ref: sec:colvars_ndx_format --></a>) or by using the <a href="https://lammps.sandia.gov/doc/group2ndx.html">group2ndx</a> LAMMPS command.
</p>
<!--l. 90--><p class="noindent"><span class="likeparagraphHead"><a id="x1-50002"></a>Example: using multiple variables and multiple biasing/analysis methods together.</span>
   A more complex example configuration is included below, showing how a variable
may be constructed by combining multiple existing functions, and how multiple
variables or multiple biases may be used concurrently. The colvar indicated below as
“<!--l. 93--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math>"
is defined as the difference between two distances (see <a href="#sec:cvc_distances">4.3<!--tex4ht:ref: sec:cvc_distances --></a>): the first distance
(<!--l. 93--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>d</mi></mrow><mrow><mn>1</mn></mrow></msub></math>) is
taken between the center of mass of atoms 1 and 2 and that of atoms 3 to 5, the second
(<!--l. 93--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>d</mi></mrow><mrow><mn>2</mn></mrow></msub></math>)
between atom 7 and the center of mass of atoms 8 to 10 (see <a href="#sec:colvar_atom_groups">5<!--tex4ht:ref: sec:colvar_atom_groups --></a>). The difference
<!--l. 94--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi> <mo class="MathClass-rel">=</mo> <msub><mrow><mi>d</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-bin">−</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>2</mn></mrow></msub></math> is obtained by multiplying
the two by a coefficient <!--l. 94--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi> <mo class="MathClass-rel">=</mo> <mo class="MathClass-bin">+</mo><mn>1</mn></math>
or <!--l. 94--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi> <mo class="MathClass-rel">=</mo> <mo class="MathClass-bin">−</mo><mn>1</mn></math>, respectively (see
<a href="#sec:cvc_superp">4.17<!--tex4ht:ref: sec:cvc_superp --></a>). The colvar called “<!--l. 95--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math>"
is the coordination number calculated between atoms 1 to 10 and atoms 11 to 20. A harmonic restraint (see <a href="#sec:colvarbias_harmonic">6.8<!--tex4ht:ref: sec:colvarbias_harmonic --></a>) is
applied to both <!--l. 95--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math> and
<!--l. 95--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math>: to allow using the
same force constant <!--l. 95--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math>,
both <!--l. 95--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math> and
<!--l. 95--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math> are scaled by their
respective fluctuation widths <!--l. 95--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>w</mi></mrow><mrow><mi>d</mi></mrow></msub></math>
and <!--l. 95--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>w</mi></mrow><mrow><mi>c</mi></mrow></msub></math>.  The
values of “<!--l. 97--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math>"
are also recorded throughout the simulation as a joint 2-dimensional histogram (see <a href="#sec:colvarbias_histogram">6.13<!--tex4ht:ref: sec:colvarbias_histogram --></a>).</p>
<div class="mdframed" id="mdframed-2">
<!--l. 99--><p class="noindent"></p><pre>colvar {<br class="newline"/>  # difference of two distances<br class="newline"/>  name d <br class="newline"/>  width 0.2  # estimated fluctuation width <br class="newline"/>  distance {<br class="newline"/>    componentCoeff  1.0<br class="newline"/>    group1 { atomNumbers 1 2 }<br class="newline"/>    group2 { atomNumbers 3 4 5 }<br class="newline"/>  }<br class="newline"/>  distance {<br class="newline"/>    componentCoeff -1.0<br class="newline"/>    group1 { atomNumbers 7 }<br class="newline"/>    group2 { atomNumbers 8 9 10 }<br class="newline"/>  }<br class="newline"/>}<br class="newline"/><br class="newline"/>colvar {<br class="newline"/>  name c<br class="newline"/>  coordNum {<br class="newline"/>    cutoff 6.0<br class="newline"/>    group1 { atomNumbersRange  1-10 }<br class="newline"/>    group2 { atomNumbersRange 11-20 }<br class="newline"/>    tolerance 1.0e-6<br class="newline"/>    pairListFrequency 1000<br class="newline"/>  }<br class="newline"/>}<br class="newline"/><br class="newline"/>harmonic {<br class="newline"/>  colvars d c<br class="newline"/>  centers 3.0 4.0<br class="newline"/>  forceConstant 5.0<br class="newline"/>}<br class="newline"/><br class="newline"/>histogram {<br class="newline"/>  colvars c<br class="newline"/>} </pre><!--l. 144--><p class="noindent"></p>
</div>
<!--l. 371--><p class="indent">
</p>
<div class="flushright">
<!--l. 371--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 371--><p class="noindent"> </p><div class="heading"> <a id="sec:colvarmodule"></a>
<h3 class="sectionHead"><span class="titlemark">3    </span> <a id="sec:colvarmodule"></a>Enabling and controlling the Colvars module in LAMMPS</h3>
<!--l. 371--><p class="noindent"></p></div>
<!--l. 373--><p class="indent">   Here, we document the syntax of the commands and parameters used to set up and use
the Colvars module in LAMMPS <span class="cite">[<a href="#XThompson2022">2</a>]</span>. One of these parameters is the configuration file or the
configuration text for the module itself, whose syntax is described in <a href="#sec:colvars_config_syntax">3.4<!--tex4ht:ref: sec:colvars_config_syntax --></a> and in the following
sections.
</p>
<div class="flushright">
<!--l. 376--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 376--><p class="noindent"> </p><div class="heading"> <a id="sec:units"></a>
<h4 class="subsectionHead"><span class="titlemark">3.1    </span> <a id="sec:units"></a>Units in the Colvars module</h4>
<!--l. 376--><p class="noindent"></p></div>
<!--l. 378--><p class="indent">   The “internal units" of the Colvars module are the units in which values are expressed in the
configuration file, and in which collective variable values, energies, etc. are expressed in the output and
colvars trajectory files. Generally <span class="phvb8t-x-x-109">the Colvars module uses internally the same units as its back-end</span>
<span class="phvb8t-x-x-109">MD engine, with the exception of VMD</span>, where different unit sets are supported to allow for
easy setup, visualization and analysis of Colvars simulations performed with any simulation
engine.
</p><!--l. 381--><p class="indent">   Note that <span class="phvb8t-x-x-109">angles </span>are expressed in degrees, and derived quantities such as force constants are based
on degrees as well. Some colvar components have default values, expressed in Ångström
(Å) in this documentation. They are converted to the current length unit, if different from Å.
Atomic coordinates read from <span class="phvb8t-x-x-109">XYZ files </span>(and PDB files where applicable) are expected to be
expressed in Ångström, no matter what unit system is in use by the back-end (LAMMPS) or the
Colvars Module. They are converted internally to the current length unit as needed. Note that
force constants in <span class="ectt-1095">harmonic </span>and <span class="ectt-1095">harmonicWalls </span>biases (<a href="#sec:colvarbias_harmonic">6.8<!--tex4ht:ref: sec:colvarbias_harmonic --></a>) are rescaled according to the
<a href="#colvar|width"><span class="ectt-1095">width</span></a> parameter of colvars, so that they are formally in energy units, although if <a href="#colvar|width"><span class="ectt-1095">width</span></a> is
given its default value of 1.0, force constants are effectively expressed in <span class="phvro8t-x-x-109">energy unit</span>/<span class="phvro8t-x-x-109">(colvar</span>
<span class="phvro8t-x-x-109">unit)</span><!--l. 384--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow></mrow><mrow><mn>2</mn></mrow></msup></math>.
</p><!--l. 386--><p class="indent">   To avoid errors due to reading configuration files written in a different unit system, it can be specified
within the input:
</p>
<ul class="itemize1">
<li class="itemize"><span class="colorbox" id="colorbox2"><a id="dx1-7001"></a><span class="ectt-1095">units</span></span> — <span class="phvro8t-x-x-109">Unit system to be used</span><br class="newline"/><!--l. 410--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-open">[</mo></math> string,
     context: global <!--l. 410--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">]</mo></math><br class="newline"/>A string defining the units to be used internally by Colvars. Supported values are the following
     LAMMPS unit styles: <span class="phvro8t-x-x-109">real </span>(Å, kcal/mol), <span class="phvro8t-x-x-109">metal </span>(Å, eV), and <span class="phvro8t-x-x-109">electron </span>(Bohr, Hartree). However
     only the unit system currently in use by LAMMPS is accepted: other values will trigger an
     error. </li></ul>
<div class="flushright">
<!--l. 531--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 531--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_mdengine_parameters"></a>
<h4 class="subsectionHead"><span class="titlemark">3.2    </span> <a id="sec:colvars_mdengine_parameters"></a>LAMMPS keywords</h4>
<!--l. 531--><p class="noindent"></p></div>
<!--l. 531--><p class="indent">   To enable a Colvars-based calculation, the following line must be added to the LAMMPS configuration
file:</p>
<div class="mdframed" id="mdframed-3">
<!--l. 531--><p class="noindent"></p><pre>fix Colvars all colvars <span class="phvro8t-x-x-109">configfile</span> [<span class="phvro8t-x-x-109">keyword value pairs ...</span>] </pre><!--l. 531--><p class="noindent"></p>
</div>
<!--l. 531--><p class="indent">   where the fix ID is here set to the string “<span class="ectt-1095">Colvars</span>", because there can only be one instance of <span class="ectt-1095">fix</span>
<span class="ectt-1095">colvars </span>in a LAMMPS run.
</p><!--l. 531--><p class="indent">   The value of the <span class="phvro8t-x-x-109">configfile </span>keyword is the name of the configuration file for the Colvars module. You
may also provide the lowercase string “none" to create an empty module, and define the configuration via
<span class="ectt-1095">fix_modify </span>(see <a href="#sec:cv_scripting">3.3<!--tex4ht:ref: sec:cv_scripting --></a>).
</p><!--l. 531--><p class="indent">   Other optional keywords for <span class="ectt-1095">fix colvars </span>are:
</p>
<ul class="itemize1">
<li class="itemize"><span class="colorbox" id="colorbox3"><a id="dx1-8001"></a><span class="ectt-1095">output</span></span> — <span class="phvro8t-x-x-109">Prefix of the output state file</span><br class="newline"/>Default: “out" <!--l. 531--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-open">[</mo></math> string,
     context: Keyword of the <span class="ectt-1095">fix colvars </span>command <!--l. 531--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">]</mo></math><br class="newline"/>If  a  value  is  provided,  it  is  interpreted  as  the  prefix  to  all  output  files  that  will  be  written
     by the Colvars module (see <a href="#sec:colvars_output">3.7<!--tex4ht:ref: sec:colvars_output --></a>). This includes output state files for checkpointing, as well
     as accumulated information such as PMFs or histograms and trajectories of the collective
     variables. Because this information is often useful, a default value is set for this keyword
     when  not  provided.  However,  supplying  an  empty  string  suppresses  any  file  output  from
     Colvars to file, except for data saved into the LAMMPS binary restart file.
     </li>
<li class="itemize"><span class="colorbox" id="colorbox4"><a id="dx1-8002"></a><span class="ectt-1095">input</span></span> — <span class="phvro8t-x-x-109">Name or prefix of the input state file (optional)</span><br class="newline"/><!--l. 531--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-open">[</mo></math> string,
     context: Keyword of the <span class="ectt-1095">fix colvars </span>command <!--l. 531--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">]</mo></math><br class="newline"/>If  a  value  is  provided,  it  is  interpreted  as  either  the  name  of  the  input  state  file,  or  as
     the prefix of the file named <span class="phvro8t-x-x-109">input</span><span class="ectt-1095">.colvars.state</span>. This file contains information needed to
     continue a previous collective variables-based calculation, including the number of the last
     computed step (useful for time-dependent biases). The same information is also stored in
     the binary restart files written by LAMMPS, so this option is generally not needed when the
     <span class="ectt-1095">read_restart </span>LAMMPS command is used.
     </li>
<li class="itemize"><span class="colorbox" id="colorbox5"><a id="dx1-8003"></a><span class="ectt-1095">unwrap</span></span> — <span class="phvro8t-x-x-109">Whether to unwrap coordinates passed to the Colvars module (optional)</span><br class="newline"/>Default: “yes" <!--l. 531--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-open">[</mo></math> “yes"
     or “no", context: keyword of the <span class="ectt-1095">fix colvars </span>command <!--l. 531--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">]</mo></math><br class="newline"/>This keyword controls whether wrapped or unwrapped coordinates are passed to the Colvars
     module for calculation of the collective variables and of the resulting forces. The default is
     to use the image flags to reconstruct the absolute atom positions: under this convention,
     centers of mass and centers of geometry are calculated as a weighted vector sum (see
     <a href="#sec:colvar_atom_groups_wrapping">5.3<!--tex4ht:ref: sec:colvar_atom_groups_wrapping --></a>). Setting this to <span class="phvro8t-x-x-109">no </span>will use the current local coordinates that are wrapped back into the
     simulation cell at each re-neighboring instead.
     </li>
<li class="itemize"><span class="colorbox" id="colorbox6"><a id="dx1-8004"></a><span class="ectt-1095">seed</span></span> — <span class="phvro8t-x-x-109">Seed for the random number generator (optional)</span><br class="newline"/>Default: 1966 <!--l. 531--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-open">[</mo></math> positive
     integer, context: Keyword of the <span class="ectt-1095">fix colvars </span>command <!--l. 531--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">]</mo></math><br class="newline"/>If defined, the value of this keyword is provided as seed to the random number generator.
     This is only meaningful when the <span class="ectt-1095">extendedLangevinDamping </span>keyword is used (see <a href="#sec:colvar_extended">4.21<!--tex4ht:ref: sec:colvar_extended --></a>).
     </li>
<li class="itemize"><span class="colorbox" id="colorbox7"><a id="dx1-8005"></a><span class="ectt-1095">tstat</span></span> — <span class="phvro8t-x-x-109">Thermostating fix (optional)</span><br class="newline"/>Default: NULL <!--l. 531--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-open">[</mo></math> string,
     context: Keyword of the <span class="ectt-1095">fix colvars </span>command <!--l. 531--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">]</mo></math><br class="newline"/>This keyword provides the <span class="phvro8t-x-x-109">ID </span>of an applicable thermostatting fix command. This will be used
     to provide the Colvars module with the current thermostat target temperature when using a
     method that needs this information.
     </li></ul>
<!--l. 531--><p class="indent">   All of the above keywords except for the name of the configuration file may also be given (or
overridden) using <span class="ectt-1095">fix_modify</span>, as well as new Colvars configuration files (see <a href="#sec:cv_scripting">3.3<!--tex4ht:ref: sec:cv_scripting --></a> for more
details).
</p>
<div class="flushright">
<!--l. 636--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 636--><p class="noindent"> </p><div class="heading"> <a id="sec:cv_scripting"></a>
<h4 class="subsectionHead"><span class="titlemark">3.3    </span> <a id="sec:cv_scripting"></a>Using the scripting interface to control the Colvars module</h4>
<!--l. 636--><p class="noindent"></p></div>
<!--l. 638--><p class="indent">   After the first initialization of the Colvars module, the internal state of Colvars objects may
be queried or modified in a LAMMPS script (here, “<span class="ectt-1095">Colvars</span>" is the ID of the <span class="ectt-1095">fix colvars</span>
instance):</p>
<div class="mdframed" id="mdframed-4">
<!--l. 639--><p class="noindent"></p><pre>fix_modify Colvars <!--l. 639--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math><span class="phvro8t-x-x-109">method</span><!--l. 639--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math> arg1 arg2 ...
</pre><!--l. 639--><p class="noindent"></p>
</div>
<!--l. 640--><p class="noindent">where <!--l. 640--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math><span class="ecit-1095">method</span><!--l. 640--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>
is the name of a specific procedure and <span class="ectt-1095">arg1</span>, <span class="ectt-1095">arg2</span>, …are its required and/or optional arguments.
</p><!--l. 667--><p class="indent">   Each <span class="ectt-1095">fix_modify </span>command may be used in either one of two ways:
     </p><ol class="enumerate1">
<li class="enumerate" id="x1-9002x1">Provide an updated value for the <span class="phvb8t-x-x-109">parameters of the fix </span>listed in <a href="#sec:colvars_mdengine_parameters">3.2<!--tex4ht:ref: sec:colvars_mdengine_parameters --></a>: this behavior is similar to that
     of several other LAMMPS fix styles, and follows the same argument parsing rules. For example,
     multiple keywords can be provided together:<div class="mdframed" id="mdframed-5">
<!--l. 667--><p class="noindent"></p><pre>fix_modify Colvars <span class="ectt-1095">seed</span> 111111 <span class="ectt-1095">tstat</span> <span class="ectt-1095">NPT </span></pre><!--l. 667--><p class="noindent"></p>
</div>
</li>
<li class="enumerate" id="x1-9004x2">Use one of the <span class="phvb8t-x-x-109">scripting functions </span>described in this section; the arguments provided as strings are
     passed to Colvars. LAMMPS variables referenced by their string representation, “<span class="ectt-1095">${variable}</span>", will
     be expanded immediately. Additionally, variable expansion <span class="phvro8t-x-x-109">will also happen within quotes</span>, similar to
     what the <span class="ectt-1095">mdi </span>command provides in a LAMMPS script: this feature makes it possible
     to use the values of certain LAMMPS variables in Colvars configuration strings (see
     <a href="#sec:cv_command_init">3.3.1<!--tex4ht:ref: sec:cv_command_init --></a>).<div class="mdframed" id="mdframed-6">
<!--l. 667--><p class="noindent"></p><pre>variable freq index 10000<br class="newline"/>dump myDump all atom/zstd ${freq} dump.atom.zstd<br class="newline"/>fix_modify Colvars config "colvarsTrajFrequency ${freq}" </pre><!--l. 667--><p class="noindent"></p>
</div>
</li></ol>
<!--l. 667--><p class="indent"> <span class="ectt-1095">fix_modify </span>can be run on a previously created instance of <span class="ectt-1095">fix colvars </span>at any time. However,
because the fix is not fully initialized until the beginning of the next simulation step, only the variables and
biases that were created prior to the most recent <span class="ectt-1095">run </span>or <span class="ectt-1095">minimize </span>command will be accessible. This fact
is true even if a Colvars configuration file that defines those variables and biases was already given in the
LAMMPS script. Should you want to trigger an immediate initialization of the Colvars module, consider
running “<span class="ectt-1095">run 0</span>".
</p><!--l. 675--><p class="indent">   In the remainder of this section, the most frequently used commands of the Colvars scripting interface
are discussed and exemplified. For a full list of scripting commands available, see section <a href="#sec:cvscript_cmdline">7<!--tex4ht:ref: sec:cvscript_cmdline --></a>.
<br class="newline"/>
</p>
<div class="flushright">
<!--l. 681--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 681--><p class="noindent"> </p><div class="heading"> <a id="sec:cv_command_init"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.3.1    </span> <a id="sec:cv_command_init"></a>Setting up the Colvars module</h5>
<!--l. 681--><p class="noindent"></p></div>
<!--l. 695--><p class="indent">   To define new collective variables and/or biases for immediate use in the current session,
configuration can be loaded from an external configuration file:</p>
<div class="mdframed" id="mdframed-7">
<!--l. 696--><p class="noindent"></p><pre>fix_modify Colvars configfile "colvars-file.in" </pre><!--l. 696--><p class="noindent"></p>
</div>
<!--l. 697--><p class="indent">   This can in principle be called at any time, if only flags internal to Colvars are being modified. In
practice, when new atoms or any new atomic properties (e.g. total forces) are being requested,
initialization steps will be required that are not carried out during a simulation. Therefore, it is generally
good practice in a simulation to change the Colvars configuration outside the scope between segments of
the same computation.
</p><!--l. 702--><p class="indent">   To load the configuration directly from a string the “<span class="ectt-1095">config</span>" method may be used:</p>
<div class="mdframed" id="mdframed-8">
<!--l. 703--><p class="noindent"></p><pre>fix_modify Colvars config "keyword { ... }" </pre><!--l. 703--><p class="noindent"></p>
</div>
<!--l. 704--><p class="noindent">This method is particularly useful to dynamically define the Colvars configuration within a LAMMPS script.
For example, when running an ensemble of umbrella sampling simulations in LAMMPS, it may be
convenient to use an identical script and define the specific window through environment
variables.
</p><!--l. 707--><p class="indent">   In the following example, the environment variable “<span class="ectt-1095">SLURM_ARRAY_TASK_ID</span>" is set in a Slurm array job
to increasing values starting at 0. The value of this variable is used to define the window's numeric index,
and the umbrella restraint center beginning at 2.00 for the first window, and increasing in increments of
0.25 for all other windows:</p>
<div class="mdframed" id="mdframed-9">
<!--l. 732--><p class="noindent"></p><pre>variable window getenv SLURM_ARRAY_TASK_ID<br class="newline"/>fix_modify Colvars config """<br class="newline"/>harmonic {<br class="newline"/>  name us_${window}<br class="newline"/>  colvars xi<br class="newline"/>  centers [expr 2.0 + 0.25 * ${window}]<br class="newline"/>  ...<br class="newline"/>}""" </pre><!--l. 732--><p class="noindent"></p>
</div>
<div class="flushright">
<!--l. 750--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 750--><p class="noindent"> </p><div class="heading"> <a id="sec:cv_command_loadsave"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.3.2    </span> <a id="sec:cv_command_loadsave"></a>Loading and saving the Colvars state and other information</h5>
<!--l. 750--><p class="noindent"></p></div>
<!--l. 752--><p class="indent">   After a configuration is fully defined, the “<span class="ectt-1095">load</span>" method may be used to load a state file from a
previous simulation that contains e.g. data from history-dependent biases), to either continue that
simulation or analyze its results:</p>
<div class="mdframed" id="mdframed-10">
<!--l. 753--><p class="noindent"></p><pre>fix_modify Colvars load "<!--l. 753--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math>oldjob<!--l. 753--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>.colvars.state"
</pre><!--l. 753--><p class="noindent"></p>
</div>
<!--l. 754--><p class="noindent">or more simply using the prefix of the state file itself:</p>
<div class="mdframed" id="mdframed-11">
<!--l. 755--><p class="noindent"></p><pre>fix_modify Colvars load "<!--l. 755--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math>oldjob<!--l. 755--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>"
</pre><!--l. 755--><p class="noindent"></p>
</div>
<!--l. 756--><p class="indent">   Anything following the “<span class="ectt-1095">.colvars.state</span>" suffix will be stripped.
</p><!--l. 758--><p class="indent">   Note that the Colvars state is already loaded automatically as part of the LAMMPS restart file, when
this is read via the LAMMPS <span class="ectt-1095">read_restart </span>command; the “<span class="ectt-1095">load</span>" method allows to load a different state
file after the fact.
</p><!--l. 776--><p class="indent">   The “<span class="ectt-1095">save</span>" method, analogous to “<span class="ectt-1095">load</span>", allows to save all restart information to a state file. This
is normally not required during a simulation if <a href="#Colvars-global|colvarsRestartFrequency"><span class="ectt-1095">colvarsRestartFrequency</span></a> is defined (either
directly or indirectly by the LAMMPS restart frequency). Because not only a state file (used to
continue simulations) but also other data files (used to analyze the trajectory) are written, it is
generally recommended to call the <span class="ectt-1095">save </span>method using a prefix, rather than a complete file
name:</p>
<div class="mdframed" id="mdframed-12">
<!--l. 779--><p class="noindent"></p><pre>fix_modify Colvars save "<!--l. 779--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math>job<!--l. 779--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>"
</pre><!--l. 779--><p class="noindent"></p>
</div>
<div class="flushright">
<!--l. 782--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 782--><p class="noindent"> </p><div class="heading"> <a id="sec:cv_command_atomic_data"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.3.3    </span> <a id="sec:cv_command_atomic_data"></a>Accessing atomic data</h5>
<!--l. 782--><p class="noindent"></p></div>
<!--l. 784--><p class="indent">   For computational efficiency the Colvars module keeps internal copies of the numeric IDs, masses,
charges, positions, and optionally total forces of the atoms requested for a Colvars computation. At each
simulation step, up-to-date versions of these properties are copied from the central memory of
LAMMPS into the internal memory of the Colvars module. In a post-processing workflow or
outside a simulation (e.g. when using VMD), this copy can be carried out as part of the <span class="ectt-1095">update</span>
method:</p>
<div class="mdframed" id="mdframed-13">
<!--l. 787--><p class="noindent"></p><pre>fix_modify Colvars update   </pre><!--l. 787--><p class="noindent"></p>
</div>
<!--l. 788--><p class="noindent">which also performs the (re-)computation of all variables and biases defined in Colvars.
                                                                                         
                                                                                         
</p><!--l. 790--><p class="indent">   For example, the current sequence of numeric IDs of the atoms processed by Colvars can be obtained
as:</p>
<div class="mdframed" id="mdframed-14">
<!--l. 791--><p class="noindent"></p><pre>fix_modify Colvars getatomids   </pre><!--l. 791--><p class="noindent"></p>
</div>
<!--l. 792--><p class="noindent">and their current positions as:</p>
<div class="mdframed" id="mdframed-15">
<!--l. 793--><p class="noindent"></p><pre>fix_modify Colvars getatompositions   </pre><!--l. 793--><p class="noindent"></p>
</div>
<!--l. 794--><p class="noindent">This may prove useful to test the correctness of the coordinates passed to Colvars, particularly in regard
to periodic boundary conditions (<a href="#sec:colvar_atom_groups_wrapping">5.3<!--tex4ht:ref: sec:colvar_atom_groups_wrapping --></a>). There is currently no mechanism to modify the above fields via the
scripting interface, but such capability will be added in the future.
</p><!--l. 800--><p class="indent">   While running a simulation, or when setting one up in VMD, it is possible to examine all the forces that
were last applied by Colvars to the atoms, or are about to be applied:</p>
<div class="mdframed" id="mdframed-16">
<!--l. 801--><p class="noindent"></p><pre>fix_modify Colvars getatomappliedforces   </pre><!--l. 801--><p class="noindent"></p>
</div>
<!--l. 802--><p class="noindent">where the length and order of this sequence matches that provided by the <span class="ectt-1095">getatomids </span>method. A simpler
way of testing the stability of a Colvars configuration before or during a simulation makes use of
aggregated data, such as the energy:</p>
<div class="mdframed" id="mdframed-17">
<!--l. 804--><p class="noindent"></p><pre>fix_modify Colvars getenergy   </pre><!--l. 804--><p class="noindent"></p>
</div>
<!--l. 805--><p class="noindent">the root-mean-square of the Colvars applied forces:</p>
<div class="mdframed" id="mdframed-18">
<!--l. 806--><p class="noindent"></p><pre>fix_modify Colvars getatomappliedforcesrms   </pre><!--l. 806--><p class="noindent"></p>
</div>
<!--l. 807--><p class="noindent">or the maximum norm of the applied forces:</p>
<div class="mdframed" id="mdframed-19">
<!--l. 808--><p class="noindent"></p><pre>fix_modify Colvars getatomappliedforcesmax   </pre><!--l. 808--><p class="noindent"></p>
</div>
<!--l. 809--><p class="noindent">which can be matched to a specific atom via its numeric ID obtained as:</p>
<div class="mdframed" id="mdframed-20">
<!--l. 810--><p class="noindent"></p><pre>fix_modify Colvars getatomappliedforcesmaxid   </pre><!--l. 810--><p class="noindent"></p>
</div>
<!--l. 812--><p class="indent">   See <a href="#sec:cvscript_cmdline_cv">7.1<!--tex4ht:ref: sec:cvscript_cmdline_cv --></a> for a complete list of scripting commands used to manage atomic data and runtime
parameters of the Colvars module.
</p>
<div class="flushright">
<!--l. 841--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 841--><p class="noindent"> </p><div class="heading"> <a id="sec:cv_command_colvar"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.3.4    </span> <a id="sec:cv_command_colvar"></a>Managing collective variables</h5>
<!--l. 841--><p class="noindent"></p></div>
<!--l. 843--><p class="indent">   After one or more collective variables are defined, they can be accessed with the following
syntax.</p>
<div class="mdframed" id="mdframed-21">
<!--l. 844--><p class="noindent"></p><pre>fix_modify Colvars colvar "<!--l. 844--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math>name<!--l. 844--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>" <!--l. 844--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math><span class="phvro8t-x-x-109">method</span><!--l. 844--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math> arg1 arg2 ...
</pre><!--l. 844--><p class="noindent"></p>
</div>
<!--l. 845--><p class="noindent">where “<!--l. 845--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math><span class="ectt-1095">name</span><!--l. 845--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>"
is the name of the variable.
</p><!--l. 847--><p class="indent">   For example, to recompute the collective variable “<span class="ectt-1095">xi</span>" after a change in its parameters, the following
command can be used:</p>
<div class="mdframed" id="mdframed-22">
<!--l. 848--><p class="noindent"></p><pre>fix_modify Colvars colvar "xi" update  </pre><!--l. 848--><p class="noindent"></p>
</div>
<!--l. 849--><p class="noindent">This ordinarily is not needed during a simulation run, where all variables are recomputed at every step
(along with biasing forces acting on them). However, when analyzing an existing trajectory, e.g. in VMD, a
call to <span class="ectt-1095">update </span>is generally required.
</p><!--l. 852--><p class="indent">   While in all typical cases all configuration of the variables is done with the “<span class="ectt-1095">config</span>" or “<span class="ectt-1095">configfile</span>"
methods, a limited set of changes can be enacted at runtime using:</p>
<div class="mdframed" id="mdframed-23">
<!--l. 853--><p class="noindent"></p><pre>fix_modify Colvars colvar "<!--l. 853--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math>name<!--l. 853--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>" modifycvcs arg1 arg2 ...
</pre><!--l. 853--><p class="noindent"></p>
</div>
<!--l. 854--><p class="noindent">where each argument is a string passed to the function or functions that are used to compute the variable,
and are called colvar components, or CVCs (<a href="#sec:cvc_list">4.1<!--tex4ht:ref: sec:cvc_list --></a>). For example, a variable “<span class="ectt-1095">DeltaZ</span>" made of a single
“<span class="ectt-1095">distanceZ</span>" component can be made periodic with a period equal to the unit cell dimension along the
<!--l. 855--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>Z</mi></math>-axis:</p>
<div class="mdframed" id="mdframed-24">
<!--l. 856--><p class="noindent"></p><pre>fix_modify Colvars colvar "DeltaZ" modifycvcs "period ${Lz}" </pre><!--l. 856--><p class="noindent"></p>
</div>
<!--l. 857--><p class="noindent">Please note that this option is currently limited to changing the values of the polynomial superposition
parameters <a href="#sec:cvc_superp"><span class="ectt-1095">componentCoeff</span></a>, or of the <a href="#sec:cvc_superp"><span class="ectt-1095">componentExp</span></a> to update on the fly, of <a href="#sec:cvc_periodic"><span class="ectt-1095">period</span></a>, <a href="#sec:cvc_periodic"><span class="ectt-1095">wrapAround</span></a> or
<a href="#colvar|cvc|forceNoPBC"><span class="ectt-1095">forceNoPBC</span></a> options for components where it is relevant. Furthermore, because the call above uses an
<span class="phvro8t-x-x-109">immediate </span>expansion of the variable “<span class="ectt-1095">${Lz}</span>", its value will not be updated during a constant-pressure
simulation.
</p><!--l. 860--><p class="indent">   If the variable is computed using many components, it is possible to selectively turn some of them on
or off:</p>
<div class="mdframed" id="mdframed-25">
<!--l. 861--><p class="noindent"></p><pre>fix_modify Colvars colvar "<!--l. 861--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math>name<!--l. 861--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>" cvcflags <!--l. 861--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math>flags<!--l. 861--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>
</pre><!--l. 861--><p class="noindent"></p>
</div>
<!--l. 862--><p class="noindent">where “<!--l. 862--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math><span class="ectt-1095">flags</span><!--l. 862--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>"
is a list of 0/1 values, one per component.
</p><!--l. 865--><p class="indent"> <span class="phvb8t-x-x-109">Important: </span>None of the changes enacted by the “<span class="ectt-1095">modifycvcs</span>" or “<span class="ectt-1095">cvcflags</span>" methods will be saved to
state files, and will be lost when restarting a simulation, deleting the corresponding collective variable, or
resetting the module with the  “<span class="ectt-1095">reset</span>" method.
                                                                                         
                                                                                         
</p>
<div class="flushright">
<!--l. 868--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 868--><p class="noindent"> </p><div class="heading"> <a id="sec:cv_command_colvar_force"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.3.5    </span> <a id="sec:cv_command_colvar_force"></a>Applying and analyzing forces on collective variables</h5>
<!--l. 868--><p class="noindent"></p></div>
<!--l. 870--><p class="indent">   As soon as a colvar “<span class="ectt-1095">xi</span>" and its associated biasing potentials are up to date (i.e. during a MD run, or
after the respective “<span class="ectt-1095">update</span>" methods have been called), the force applied onto the colvar is known and
may be accessed through the <span class="ectt-1095">getappliedforce </span>method:</p>
<div class="mdframed" id="mdframed-26">
<!--l. 871--><p class="noindent"></p><pre>fix_modify Colvars colvar "xi" getappliedforce  </pre><!--l. 871--><p class="noindent"></p>
</div>
<!--l. 872--><p class="noindent">See also the use of the <a href="#colvar|outputAppliedForce"><span class="ectt-1095">outputAppliedForce</span></a> option to have this force be saved to file during a
simulation.
</p><!--l. 874--><p class="indent">   Aside from the biasing methods already implemented within Colvars (<a href="#sec:colvarbias">6<!--tex4ht:ref: sec:colvarbias --></a>) this force may be incremented
<span class="phvro8t-x-x-109">ad hoc</span>:</p>
<div class="mdframed" id="mdframed-27">
<!--l. 875--><p class="noindent"></p><pre>fix_modify Colvars colvar "xi" addforce <!--l. 875--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math>force<!--l. 875--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>
</pre><!--l. 875--><p class="noindent"></p>
</div>
<!--l. 876--><p class="noindent">where “<!--l. 876--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math><span class="ectt-1095">force</span><!--l. 876--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math>"
is a scalar or a vector (depending on the type of variable “<span class="ectt-1095">xi</span>").  Although this would offer in principle a way
to add custom forces to a variable, <span class="ectt-1095">fix_modify </span>is executed outside the <span class="ectt-1095">run </span>or <span class="ectt-1095">minimize </span>commands, and
the given force will be reset during a simulation.
</p><!--l. 881--><p class="indent">   For certain types of variable, the force applied directly on a colvar may be combined with those acting
<span class="phvro8t-x-x-109">indirectly </span>on it via the interatomic force field, making up the <span class="phvro8t-x-x-109">total force</span>. When the <a href="#colvar|outputTotalForce"><span class="ectt-1095">outputTotalForce</span></a>
keyword is enabled, or when a biasing method that makes explicit use of the total force is enabled, the
total force may be obtained as:</p>
<div class="mdframed" id="mdframed-28">
<!--l. 883--><p class="noindent"></p><pre>fix_modify Colvars colvar "xi" gettotalforce  </pre><!--l. 883--><p class="noindent"></p>
</div>
<!--l. 884--><p class="noindent">Note that not all types of variable support total-force computation, and the value of the total force may not
be available immediately within the same simulation step: see the documentation of <a href="#colvar|outputTotalForce"><span class="ectt-1095">outputTotalForce</span></a>
for more details.
</p><!--l. 886--><p class="indent">   See <a href="#sec:cvscript_cmdline_colvar">7.2<!--tex4ht:ref: sec:cvscript_cmdline_colvar --></a> for a complete list of scripting commands used to manage collective variables.
</p>
<div class="flushright">
<!--l. 889--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 889--><p class="noindent"> </p><div class="heading"> <a id="sec:cv_command_bias"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.3.6    </span> <a id="sec:cv_command_bias"></a>Managing collective variable biases</h5>
<!--l. 889--><p class="noindent"></p></div>
<!--l. 891--><p class="indent">   Because biases depend only upon data internal to the Colvars module (i.e. they do not need atomic
coordinates from LAMMPS), it is generally easy to create them or update their configuration at any time.
For example, given the most current value of the variable “<span class="ectt-1095">xi</span>", an already-defined harmonic restraint on it
named “<span class="ectt-1095">h_xi</span>" can be updated as:</p>
<div class="mdframed" id="mdframed-29">
<!--l. 893--><p class="noindent"></p><pre>fix_modify Colvars bias "h_xi" update  </pre><!--l. 893--><p class="noindent"></p>
</div>
<!--l. 894--><p class="noindent">During a running simulation this step is not needed, because an automatic update of each bias is already
carried out.
</p>
<div class="flushright">
<!--l. 922--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 922--><p class="noindent"> </p><div class="heading"> <a id="sec:cv_command_bias_loadsave"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.3.7    </span> <a id="sec:cv_command_bias_loadsave"></a>Loading and saving the state of individual biases</h5>
<!--l. 922--><p class="noindent"></p></div>
<!--l. 924--><p class="indent">   Some types of bias are history-dependent, and the magnitude of their forces depends not only on the
values of their corresponding variables, but also on previous simulation history. It is thus useful to
load information from a state file that contains information specifically for one bias only, for
example:</p>
<div class="mdframed" id="mdframed-30">
<!--l. 926--><p class="noindent"></p><pre>fix_modify Colvars bias "metadynamics1" load "old.colvars.state" </pre><!--l. 926--><p class="noindent"></p>
</div>
<!--l. 927--><p class="noindent">or alternatively, using the prefix of the file instead of its full name:</p>
<div class="mdframed" id="mdframed-31">
<!--l. 928--><p class="noindent"></p><pre>fix_modify Colvars bias "metadynamics1" load "old" </pre><!--l. 928--><p class="noindent"></p>
</div>
<!--l. 929--><p class="indent">   A corresponding “<span class="ectt-1095">save</span>" function is also available:</p>
<div class="mdframed" id="mdframed-32">
<!--l. 930--><p class="noindent"></p><pre>fix_modify Colvars bias "metadynamics1" save "new" </pre><!--l. 930--><p class="noindent"></p>
</div>
<!--l. 931--><p class="noindent">Please note that the file above must contain only the state information for that particular bias: <span class="phvro8t-x-x-109">loading a</span>
<span class="phvro8t-x-x-109">state file for the whole module is not allowed.</span>
</p><!--l. 933--><p class="indent">   This pair of functions is also used internally by Colvars to implement e.g. multiple-walker
metadynamics (<a href="#sec:colvarbias_meta_mr">6.6.7<!--tex4ht:ref: sec:colvarbias_meta_mr --></a>), but they can be called from a scripted function to implement alternative coupling
schemes.
</p><!--l. 935--><p class="indent">   See <a href="#sec:cvscript_cmdline_bias">7.3<!--tex4ht:ref: sec:cvscript_cmdline_bias --></a> for a complete list of scripting commands used to manage biases.
</p>
<div class="flushright">
<!--l. 940--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 940--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_config_syntax"></a>
<h4 class="subsectionHead"><span class="titlemark">3.4    </span> <a id="sec:colvars_config_syntax"></a>Configuration syntax used by the Colvars module</h4>
<!--l. 940--><p class="noindent"></p></div>
<!--l. 942--><p class="indent">   Configuration for the Colvars module is passed using an external file. Configuration lines follow the
format “<span class="ectt-1095">keyword value</span>" or “<span class="ectt-1095">keyword { ... }</span>", where the keyword and its value must be separated by
one or more space characters. The following formatting rules apply:
</p>
<ul class="itemize1">
<li class="itemize"><span class="phvro8t-x-x-109">Keywords are case-insensitive</span>; for example, <span class="ectt-1095">upperBoundary </span>is the same as <span class="ectt-1095">upperboundary</span>
     and <span class="ectt-1095">UPPERBOUNDARY</span>); note that their string values are however still case-sensitive (e.g. names
     of variables, file names).
     </li>
<li class="itemize">A long value, or a list of multiple values, can be distributed across multiple lines by using
     <span class="phvro8t-x-x-109">curly braces</span>, “<span class="ectt-1095">{</span>" and “<span class="ectt-1095">}</span>": the opening brace “<span class="ectt-1095">{</span>" must occur on the same line as the keyword,
     following at least one space character; the closing brace “<span class="ectt-1095">}</span>" may be at any position after that;
     any keywords following the closing brace on the same line are not valid (they should appear
     instead on a different line).
     </li>
<li class="itemize">Many keywords are nested, and are only meaningful within the specific context of another
     keyword; for example, the keyword <span class="ectt-1095">name </span>is available inside the block of the keyword <span class="ectt-1095">colvar</span>
<span class="ectt-1095">{...}</span>,  but  not  outside  of  it;  for  every  keyword  documented  in  the  following,  the  <span class="phvro8t-x-x-109">“parent"</span>
<span class="phvro8t-x-x-109">keyword </span>that defines such context is also indicated.
     </li>
<li class="itemize">If a keyword requiring a boolean value (<span class="ectt-1095">yes|on|true </span>or <span class="ectt-1095">no|off|false</span>) is provided without an
     explicit value, it defaults to ‘<span class="ectt-1095">yes|on|true</span>'; for example, ‘<span class="ectt-1095">outputAppliedForce</span>' may be used
     as shorthand for ‘<span class="ectt-1095">outputAppliedForce on</span>'.
     </li>
<li class="itemize">The hash character “<span class="ectt-1095">#</span>" indicates a <span class="phvro8t-x-x-109">comment</span>: all text in the same line following this character
     will be ignored.
     </li>
<li class="itemize">Outside of comments, <span class="phvro8t-x-x-109">only ASCII characters </span>are allowed for defining keywords, and the only
     white-space characters supported are spaces, tabs and newlines: a warning will be printed
     upon detection of non-ASCII characters in a configuration line, which include both characters
     that are visibly “special", as well as those with a very similar appearance to ASCII ones (for
     instance, <a href="https://en.wikipedia.org/wiki/Non-breaking_space">non-breaking spaces</a>); common ways to identify/remove non-ASCII characters are
     using the Emacs text editor, or using <span class="ectt-1095">LC_ALL=C vi</span>.
     </li></ul>
<div class="flushright">
<!--l. 967--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 967--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_global"></a>
<h4 class="subsectionHead"><span class="titlemark">3.5    </span> <a id="sec:colvars_global"></a>Global keywords</h4>
<!--l. 967--><p class="noindent"></p></div>
<!--l. 969--><p class="indent">   The following keywords are available in the global context of the Colvars configuration, i.e. they are
not nested inside other keywords: </p>
<ul class="itemize1">
<li class="itemize"><a id="Colvars-global|colvarsTrajFrequency"></a> <span class="colorbox" id="colorbox8"><a id="dx1-18001"></a><span class="ectt-1095">colvarsTrajFrequency</span></span> — <span class="phvro8t-x-x-109">Colvar value trajectory frequency</span><br class="newline"/>Default: 100 <!--l. 982--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-open">[</mo></math> positive
     integer, context: global <!--l. 982--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">]</mo></math><br class="newline"/>The values of each colvar (and of other related quantities, if requested) are written to the file
     <span class="phvro8t-x-x-109">output</span><span class="ectt-1095">.colvars.traj </span>every these many steps throughout the simulation. If the value is 0,
     such trajectory file is not written. For optimization the output is buffered, and synchronized
     with the disk only when the restart file is being written.
     </li>
<li class="itemize"><a id="Colvars-global|colvarsRestartFrequency"></a> <span class="colorbox" id="colorbox9"><a id="dx1-18002"></a><span class="ectt-1095">colvarsRestartFrequency</span></span> — <span class="phvro8t-x-x-109">Colvar module restart frequency</span><br class="newline"/>Default: LAMMPS <span class="ectt-1095">restart </span>frequency when defined <!--l. 997--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-open">[</mo></math> positive
     integer, context: global <!--l. 997--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">]</mo></math><br class="newline"/>When this value is non-zero, a state file suitable for restarting will be written every these many
     steps. Additionally, any other output files produced by Colvars are written as well (except the
     trajectory file, which is written every <a href="#Colvars-global|colvarsTrajFrequency"><span class="ectt-1095">colvarsTrajFrequency</span></a> steps).   It is generally a good
     idea to leave this parameter at its default value, unless needed for special cases or to disable
     automatic writing of output files altogether.   If neeed, writing of all output files can still be
     triggered at any time via the <span class="ectt-1095">save </span>scripting function.
     </li>
<li class="itemize"><a id="Colvars-global|indexFile"></a> <span class="colorbox" id="colorbox10"><a id="dx1-18003"></a><span class="ectt-1095">indexFile</span></span> — <span class="phvro8t-x-x-109">Index file for atom selection (GROMACS “ndx" format)</span><br class="newline"/><!--l. 1016--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-open">[</mo></math> UNIX
     filename, context: global <!--l. 1016--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">]</mo></math><br class="newline"/>This option reads an index file (usually with a <span class="ectt-1095">.ndx </span>extension) as produced by the <span class="ectt-1095">make_ndx</span>
     tool  of  GROMACS.  This  keyword  may  be  repeated  to  load  multiple  index  files.  A  group
     with the same name may appear multiple times, as long as it contains the same indices in
     identical order each time: an error is raised otherwise. In LAMMPS, the <a href="https://lammps.sandia.gov/doc/group2ndx.html">group2ndx</a> command
     can be used to generate such file from existing groups. Note that the Colvars module reads
     the  indices  of  atoms  from  the  index  file:  therefore,  the  LAMMPS  groups  do  not  need  to
     remain active during the simulation, and could be deleted right after issuing <span class="ectt-1095">group2ndx</span>.  The
     names of index groups contained in this file can then be used to define atom groups with the
     <span class="ectt-1095">indexGroup </span>keyword. Other supported methods to select atoms are described in <a href="#sec:colvar_atom_groups">5<!--tex4ht:ref: sec:colvar_atom_groups --></a>.
                                                                                         
                                                                                         
     </li>
<li class="itemize"><a id="Colvars-global|smp"></a> <span class="colorbox" id="colorbox11"><a id="dx1-18004"></a><span class="ectt-1095">smp</span></span> — <span class="phvro8t-x-x-109">Whether SMP parallelism should be used</span><br class="newline"/>Default: <span class="ectt-1095">on</span> <!--l. 1026--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-open">[</mo></math> boolean,
     context: global <!--l. 1026--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">]</mo></math><br class="newline"/>If this flag is enabled (default), SMP parallelism over threads will be used to compute variables
     and biases, provided that this is supported by the LAMMPS build in use.
     </li></ul>
<div class="flushright">
<!--l. 1042--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1042--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_input"></a>
<h4 class="subsectionHead"><span class="titlemark">3.6    </span> <a id="sec:colvars_input"></a>Input state file</h4>
<!--l. 1042--><p class="noindent"></p></div>
<!--l. 1044--><p class="indent">   Several of the sampling methods implemented in Colvars are time- or history-dependent, i.e. they
work by accumulating data as a simulation progresses, and use these data to determine their biasing
forces. If the simulation engine uses a checkpoint or restart file (as GROMACS and LAMMPS do), any
data needed by Colvars are embedded into that file. Otherwise, a dedicated <span class="phvro8t-x-x-109">state file </span>can be loaded into
Colvars directly.
</p><!--l. 1046--><p class="indent">   When a dedicated Colvars state file is used, it may be in either one of two formats: </p>
<ul class="itemize1">
<li class="itemize">Formatted, i.e. <span class="phvro8t-x-x-109">“text" </span>format, which takes more space and is slower to to load/save but is also
     portable across different platforms and even different simulation engines (save for changes
     in physical units). This format is used by default, unless explicitly requested otherwise.
     </li>
<li class="itemize">Unformatted, i.e. <span class="phvro8t-x-x-109">“binary"  </span>format, which is both space-efficient and quick to load/save, but
     requires  that  the  same  LAMMPS  build  was  used  to  write  the  file  and  that  the  Colvars
     configuration  remains  the  same.  This  format  is  supported  by  Colvars  versions  starting
     2023-09-25. Colvars state files can be written in binary format by setting the environment
     variable “<span class="ectt-1095">COLVARS_BINARY_RESTART</span>" to 1.
     </li></ul>
<!--l. 1058--><p class="indent">   In either format, the state file contains accumulated data as well as the step number at the end of the
run. The step number read from a state file overrides any value that LAMMPS provides, and will be
incremented if the simulation proceeds. This means that the step number used internally by Colvars may
not always match the step number reported by LAMMPS.
</p>
<div class="flushright">
<!--l. 1089--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1089--><p class="noindent"> </p><div class="heading"> <a></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.6.1    </span> <a id=""></a>Restarting in LAMMPS.</h5>
<!--l. 1089--><p class="noindent"></p></div> For continuing a Colvars-based simulation, the recommended method is using the standard LAMMPS
<span class="ectt-1095">read_restart </span>command, which reads the Colvars state data from the LAMMPS restart file (in binary
format).
<div class="mdframed" id="mdframed-33">
<!--l. 1089--><p class="noindent"></p><pre>read_restart <span class="phvro8t-x-x-109">filename </span></pre><!--l. 1089--><p class="noindent"></p>
</div>
<!--l. 1089--><p class="indent">   Alternatively, restarting from a Colvars-specific state file is also possible by providing the <span class="ectt-1095">input</span>
keyword to the <span class="ectt-1095">fix colvars </span>command:</p>
<div class="mdframed" id="mdframed-34">
<!--l. 1089--><p class="noindent"></p><pre>fix Colvars all colvars <span class="phvro8t-x-x-109">configfile</span> input <span class="phvro8t-x-x-109">input_prefix </span></pre><!--l. 1089--><p class="noindent"></p>
</div>
<!--l. 1089--><p class="indent">   When the “<span class="ectt-1095">input</span>" keyword is used, the contents of the file
<!--l. 1089--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math><span class="ecit-1095">input_prefix</span><!--l. 1089--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math><span class="ectt-1095">.colvar.state</span>
override the information read from the LAMMPS restart file. Finally, a state file may also be loaded after
initialization through the “<span class="ectt-1095">fix_modify</span>" command:</p>
<div class="mdframed" id="mdframed-35">
<!--l. 1089--><p class="noindent"></p><pre>fix_modify Colvars <span class="ectt-1095">input</span> <span class="phvro8t-x-x-109">new_input_prefix </span></pre><!--l. 1089--><p class="noindent"></p>
</div>
<div class="flushright">
<!--l. 1099--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1099--><p class="noindent"> </p><div class="heading"> <a id="sec:change_config_restart"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.6.2    </span> <a id="sec:change_config_restart"></a>Changing configuration upon restarting.</h5>
<!--l. 1099--><p class="noindent"></p></div>
<!--l. 1101--><p class="indent">   In some cases, it is useful to modify the configuration of variables or biases between consecutive runs,
for example by adding or removing a restraint. Some special provisions will happen in that case. When a
state file is loaded, no information is available about any newly added variable or bias, which will
thus remain uninitialized until the first compute step. Conversely, any information that the
state file may contain about variables or biases that are no longer defined will be silently
ignored. Please note that these checks are performed based only on the <span class="phvro8t-x-x-109">names </span>of variables and
biases: it is your responsibility to ensure that these names have <span class="phvro8t-x-x-109">consistent definitions between</span>
<span class="phvro8t-x-x-109">runs.</span>
</p><!--l. 1107--><p class="indent">   The flexibility just described carries some limitations: namely, it is only supported when reading
<span class="phvro8t-x-x-109">text-format </span>Colvars state files. Instead, restarting from binary files (such as the LAMMPS restart file) after
a configuration change will trigger an error. It is also important to remind that when switching to a different
build of LAMMPS, the binary format may change slightly, even if the release version is the
same.
                                                                                         
                                                                                         
</p><!--l. 1111--><p class="indent">   To work around the potential issues just described, a text-format Colvars state file should be loaded.
This can be achieved by providing an explicit <span class="ectt-1095">input </span>keyword when initializing the Colvars fix (see
<a href="#sec:colvars_mdengine_parameters">3.2<!--tex4ht:ref: sec:colvars_mdengine_parameters --></a>), which will instruct Colvars to use the given filename, instead of the LAMMPS restart file.
Furthermore, the <span class="ectt-1095">fix_modify </span>scripting command allows to load a Colvars file after initialization
(<a href="#sec:cv_command_loadsave">3.3.2<!--tex4ht:ref: sec:cv_command_loadsave --></a>).
</p>
<div class="flushright">
<!--l. 1131--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1131--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_output"></a>
<h4 class="subsectionHead"><span class="titlemark">3.7    </span> <a id="sec:colvars_output"></a>Output files</h4>
<!--l. 1131--><p class="noindent"></p></div>
<!--l. 1133--><p class="indent">   When the output prefix <span class="phvro8t-x-x-109">output </span>is defined, the following output files are written during a simulation
run:
</p>
<ul class="itemize1">
<li class="itemize">A <span class="phvro8t-x-x-109">state file</span>, named <span class="phvro8t-x-x-109">output</span><span class="ectt-1095">.colvars.state</span>, which is written at the end of the specified run.
     This  file  is  in  plain  text  format  by  default,  or  in  binary  format  if  the  environment  variable
     <span class="ectt-1095">COLVARS_BINARY_RESTART </span>is set to a non-zero integer. The state file can be used to continue
     a simulation: unless its contents are embedded in the checkpoint file of the MD engine itself
     (currently, GROMACS and LAMMPS support this), instructions for loading the Colvars state
     file will be required in the simulation script (see <a href="#sec:colvars_input">3.6<!--tex4ht:ref: sec:colvars_input --></a>).
     </li>
<li class="itemize">If  the  parameter  <a href="#Colvars-global|colvarsRestartFrequency"><span class="ectt-1095">colvarsRestartFrequency</span></a> is  larger  than  zero  and  the  <span class="phvro8t-x-x-109">restart  </span>prefix  is
     defined, a <span class="phvro8t-x-x-109">restart file </span>is written every that many steps: this file is fully equivalent to the final
     state file. The name of this file is <span class="phvro8t-x-x-109">restart</span><span class="ectt-1095">.colvars.state</span>.
     </li>
<li class="itemize">If  the  parameter  <a href="#Colvars-global|colvarsTrajFrequency"><span class="ectt-1095">colvarsTrajFrequency</span></a> is  greater  than  0  (default  value:  100  steps),  a
     <span class="phvro8t-x-x-109">trajectory file</span>, named <span class="phvro8t-x-x-109">output</span><span class="ectt-1095">.colvars.traj</span>, is written during the simulation. Unlike a state
     file, this file is not needed to restart a simulation, but can be used for post-processing and
     analysis. The format of this file is described in sec. <a href="#sec:colvars_traj_format">3.8.5<!--tex4ht:ref: sec:colvars_traj_format --></a>.
     </li>
<li class="itemize">Additionally, certain features, when enabled, can emit output files with a specific purpose:
     for example, potentials of mean force (PMFs) can be written to file to be analyzed or plotted.
     These files are described in the respective sections, but as a general rule they all use names
     beginning with the <span class="phvro8t-x-x-109">output </span>prefix. Like the trajectory file, these additional files are needed only
     for analyzing a simulation's results, but not to continue it.
     </li></ul>
<div class="flushright">
<!--l. 1154--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1154--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_file_formats"></a>
<h4 class="subsectionHead"><span class="titlemark">3.8    </span> <a id="sec:colvars_file_formats"></a>File formats</h4>
<!--l. 1154--><p class="noindent"></p></div>
<!--l. 1156--><p class="indent">   This section summarizes the file formats of various files that Colvars may be reading or
writing.
</p>
<div class="flushright">
<!--l. 1158--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1158--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_text_format"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.8.1    </span> <a id="sec:colvars_text_format"></a>Configuration and state files.</h5>
<!--l. 1158--><p class="noindent"></p></div>
<!--l. 1160--><p class="indent"> <span class="phvro8t-x-x-109">Configuration files </span>are text files that are generally read as input by LAMMPS. Starting from version
2017-02-01, changes in newline encodings are handled transparently, i.e. it is possible to typeset a
configuration file in Windows (CR-LF newlines) and then use it with Linux or macOS (LF-only
newlines).
</p><!--l. 1163--><p class="indent"> <span class="phvro8t-x-x-109">Formatted state files</span>, although not written manually, follow otherwise the same text format as
configuration files. <span class="ectt-1095">Binary state files </span>can only be read by the Colvars code itself.
</p>
<div class="flushright">
<!--l. 1166--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1166--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_ndx_format"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.8.2    </span> <a id="sec:colvars_ndx_format"></a>Index (NDX) files</h5>
<!--l. 1166--><p class="noindent"></p></div>
<!--l. 1168--><p class="indent">   For atom selections that cannot be specified only by using internal Colvars keywords, external <span class="phvro8t-x-x-109">index</span>
<span class="phvro8t-x-x-109">files </span>may also be used following the <a href="http://manual.gromacs.org/documentation/current/reference-manual/file-formats.html#ndx">NDX format</a> used in GROMACS:
                                                                                         
                                                                                         
</p>
<div class="mdframed" id="mdframed-36">
<!--l. 1169--><p class="noindent"></p><pre>[ group_1_name ]<br class="newline"/>  i1  i2  i3  i4  ...<br class="newline"/>  ...             ...  iN<br class="newline"/>[ group_2_name ]<br class="newline"/>  ... </pre><!--l. 1175--><p class="noindent"></p>
</div>
<!--l. 1176--><p class="noindent">where <span class="phvro8t-x-x-109">i1 </span>through <span class="phvro8t-x-x-109">iN </span>are 1-based indices. Each group name may not contain spaces or tabs: otherwise, a
parsing error will be raised.
</p><!--l. 1178--><p class="indent">   Multiple index files may be provided to Colvars, each using the keyword <a href="#Colvars-global|indexFile"><span class="ectt-1095">indexFile</span></a>. Two index files
may contain groups with the same names, however these must also represent identical atom selections,
i.e. the same sequence of indices including order.
</p><!--l. 1182--><p class="indent">   Other than with GROMACS, an index group may also be generated from the VMD command-line
interface, using the helper function <span class="ectt-1095">write_index_group </span>provided in the <span class="ectt-1095">colvartools </span>folder:</p>
<div class="mdframed" id="mdframed-37">
<!--l. 1183--><p class="noindent"></p><pre>source colvartools/write_index_group.tcl<br class="newline"/>set sel [atomselect top "resname XXX and not hydrogen"]<br class="newline"/>write_index_group indexfile.ndx $sel "Ligand" </pre><!--l. 1187--><p class="noindent"></p>
</div>
<!--l. 1188--><p class="indent">   In LAMMPS, NDX files may also be generated from internal groups via the <span class="ectt-1095">group2ndx</span>
command.
</p>
<div class="flushright">
<!--l. 1191--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1191--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_xyz_format"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.8.3    </span> <a id="sec:colvars_xyz_format"></a>XYZ coordinate files</h5>
<!--l. 1191--><p class="noindent"></p></div> XYZ coordinate files are text files with the extension “<span class="ectt-1095">.xyz</span>". They are read by the Colvars module using
an internal reader, and expect the following format:
<!--l. 1194--><p class="noindent"><!--tex4ht:inline--></p><div class="tabular"> <table class="tabular" id="TBL-1"><colgroup id="TBL-1-1g"><col id="TBL-1-1"/><col id="TBL-1-2"/><col id="TBL-1-3"/><col id="TBL-1-4"/></colgroup><tr id="TBL-1-1-" style="vertical-align:baseline;"><td class="td11" id="TBL-1-1-1" style="text-align:right; white-space:nowrap;"> <!--l. 1195--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> </td>
</tr><tr id="TBL-1-2-" style="vertical-align:baseline;"><td class="td11" id="TBL-1-2-1" style="text-align:right; white-space:nowrap;"> </td><td class="td11" id="TBL-1-2-2" style="text-align:right; white-space:nowrap;"> <span class="phvro8t-x-x-109">Comment  </span></td><td class="td11" id="TBL-1-2-3" style="text-align:right; white-space:nowrap;"> <span class="phvro8t-x-x-109">line  </span></td><td class="td11" id="TBL-1-2-4" style="text-align:right; white-space:nowrap;"> </td></tr><tr id="TBL-1-3-" style="vertical-align:baseline;"><td class="td11" id="TBL-1-3-1" style="text-align:right; white-space:nowrap;"> <!--l. 1197--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>E</mi></mrow><mrow>
<mn>1</mn></mrow></msub></math> </td><td class="td11" id="TBL-1-3-2" style="text-align:right; white-space:nowrap;"> <!--l. 1197--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub></math> </td><td class="td11" id="TBL-1-3-3" style="text-align:right; white-space:nowrap;"> <!--l. 1197--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow></msub></math> </td><td class="td11" id="TBL-1-3-4" style="text-align:right; white-space:nowrap;"> <!--l. 1197--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>z</mi></mrow><mrow><mn>1</mn></mrow></msub></math> </td>
</tr><tr id="TBL-1-4-" style="vertical-align:baseline;"><td class="td11" id="TBL-1-4-1" style="text-align:right; white-space:nowrap;"> <!--l. 1198--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>E</mi></mrow><mrow><mn>2</mn></mrow></msub></math> </td><td class="td11" id="TBL-1-4-2" style="text-align:right; white-space:nowrap;"> <!--l. 1198--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msub></math> </td><td class="td11" id="TBL-1-4-3" style="text-align:right; white-space:nowrap;"> <!--l. 1198--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msub></math> </td><td class="td11" id="TBL-1-4-4" style="text-align:right; white-space:nowrap;"> <!--l. 1198--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>z</mi></mrow><mrow><mn>2</mn></mrow></msub></math> </td>
</tr><tr id="TBL-1-5-" style="vertical-align:baseline;"><td class="td11" id="TBL-1-5-1" style="text-align:right; white-space:nowrap;">                                                                                    …  </td>
</tr><tr id="TBL-1-6-" style="vertical-align:baseline;"><td class="td11" id="TBL-1-6-1" style="text-align:right; white-space:nowrap;"> <!--l. 1200--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>E</mi></mrow><mrow><mi>N</mi></mrow></msub></math> </td><td class="td11" id="TBL-1-6-2" style="text-align:right; white-space:nowrap;"> <!--l. 1200--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>x</mi></mrow><mrow><mi>N</mi></mrow></msub></math> </td><td class="td11" id="TBL-1-6-3" style="text-align:right; white-space:nowrap;"> <!--l. 1200--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>y</mi></mrow><mrow><mi>N</mi></mrow></msub></math> </td><td class="td11" id="TBL-1-6-4" style="text-align:right; white-space:nowrap;"> <!--l. 1200--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>z</mi></mrow><mrow><mi>N</mi></mrow></msub></math> </td>
</tr><tr id="TBL-1-7-" style="vertical-align:baseline;"><td class="td11" id="TBL-1-7-1" style="text-align:right; white-space:nowrap;"> </td></tr></table>
</div>
<!--l. 1203--><p class="noindent">where <!--l. 1203--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is the number of atomic
coordinates in the file and <!--l. 1203--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>E</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is
the chemical element of the <!--l. 1203--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math>-th
atom. Because <!--l. 1204--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>E</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
is not used in Colvars, any string that does not contain tabs or spaces is acceptable.
</p><!--l. 1206--><p class="indent"> <span class="phvb8t-x-x-109">Note: </span>all XYZ coordinates are assumed to be expressed in Å units, regardless of the units currently
used by LAMMPS.
</p><!--l. 1208--><p class="indent">   An XYZ file may contain either one of the following scenarios:
                                                                                         
                                                                                         
     </p><ol class="enumerate1">
<li class="enumerate" id="x1-26001x3.8.3">The  file  contains  as  many  coordinates  as  the  atoms  that  they  are  being  read  for:  all
     coordinates will be read from the file following the same order as the atoms appear in the
     selection generated using the keywords listed in section <a href="#sec:colvar_atom_groups">5<!--tex4ht:ref: sec:colvar_atom_groups --></a>. (Note that the order is guaranteed
     only if a single type of selection keyword is used one or more times, and not guaranteed
     when different types of selection keywords are used.)
     </li>
<li class="enumerate" id="x1-26002x3.8.3">The file contains more coordinates than needed, and it is assumed to contain coordinates
     for the entire system: only coordinates that match the numeric indices of the selected atoms
     are read, in order of increasing number.</li></ol>
<!--l. 1215--><p class="indent">   XYZ-file coordinates are read directly by Colvars and stored internally as double-precision floating
point numbers.
</p>
<div class="flushright">
<!--l. 1247--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1247--><p class="noindent"> </p><div class="heading"> <a id="sec:colvar_multicolumn_grid"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.8.4    </span> <a id="sec:colvar_multicolumn_grid"></a>Grid files: multicolumn text format</h5>
<!--l. 1247--><p class="noindent"></p></div>
<!--l. 1249--><p class="indent">   Many simulation methods and analysis tools write files that contain functions of the collective variables
tabulated on a grid (e.g. potentials of mean force or multidimensional histograms) for the purpose of
analyzing results. Such files are produced by ABF (<a href="#sec:colvarbias_abf">6.3<!--tex4ht:ref: sec:colvarbias_abf --></a>), metadynamics (<a href="#sec:colvarbias_meta">6.6<!--tex4ht:ref: sec:colvarbias_meta --></a>), multidimensional
histograms (<a href="#sec:colvarbias_histogram">6.13<!--tex4ht:ref: sec:colvarbias_histogram --></a>), as well as any restraint with optional thermodynamic integration support
(<a href="#sec:colvarbias_ti">6.2<!--tex4ht:ref: sec:colvarbias_ti --></a>).
</p><!--l. 1252--><p class="indent">   In some cases, these files may also be read as input of a new simulation. Suitable input files for
this purpose are typically generated as output files of previous simulations, or directly by
the user in the specific case of ensemble-biased metadynamics (<a href="#sec:colvarbias_ebmeta">6.6.5<!--tex4ht:ref: sec:colvarbias_ebmeta --></a>). This section
explains the “multicolumn" format used by these files. For a multidimensional function
<!--l. 1255--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow></msub></math>,
<!--l. 1255--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><mn>2</mn></mrow></msub></math>,
…<!--l. 1255--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">)</mo></math> the
multicolumn grid format is defined as follows:<br class="newline"/>
</p>
<div class="tabular"> <table class="tabular" id="TBL-2"><colgroup id="TBL-2-1g"><col id="TBL-2-1"/><col id="TBL-2-2"/><col id="TBL-2-3"/><col id="TBL-2-4"/><col id="TBL-2-5"/><col id="TBL-2-6"/><col id="TBL-2-7"/></colgroup><tr id="TBL-2-1-" style="vertical-align:baseline;"><td class="td11" id="TBL-2-1-1" style="text-align:left; white-space:nowrap;"> #  </td><td class="td11" id="TBL-2-1-2" style="text-align:left; white-space:nowrap;"> <!--l. 1258--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></math> </td><td class="td11" id="TBL-2-1-3" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-2-1-4" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-2-1-5" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-2-1-6" style="text-align:left; white-space:nowrap;"> </td>
</tr><tr id="TBL-2-2-" style="vertical-align:baseline;"><td class="td11" id="TBL-2-2-1" style="text-align:left; white-space:nowrap;"> #   </td><td class="td11" id="TBL-2-2-2" style="text-align:left; white-space:nowrap;"> <!--l. 1259--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>m</mi><mi>i</mi><mi>n</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-close">)</mo></math> </td><td class="td11" id="TBL-2-2-3" style="text-align:left; white-space:nowrap;"> <!--l. 1259--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-close">)</mo></math> </td><td class="td11" id="TBL-2-2-4" style="text-align:left; white-space:nowrap;"> <!--l. 1259--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>n</mi><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>s</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-close">)</mo></math> </td><td class="td11" id="TBL-2-2-5" style="text-align:left; white-space:nowrap;"> <!--l. 1259--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>p</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>d</mi><mi>i</mi><mi>c</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-close">)</mo></math> </td>
</tr><tr id="TBL-2-3-" style="vertical-align:baseline;"><td class="td11" id="TBL-2-3-1" style="text-align:left; white-space:nowrap;"> #   </td><td class="td11" id="TBL-2-3-2" style="text-align:left; white-space:nowrap;"> <!--l. 1260--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>m</mi><mi>i</mi><mi>n</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-close">)</mo></math> </td><td class="td11" id="TBL-2-3-3" style="text-align:left; white-space:nowrap;"> <!--l. 1260--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-close">)</mo></math> </td><td class="td11" id="TBL-2-3-4" style="text-align:left; white-space:nowrap;"> <!--l. 1260--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>n</mi><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>s</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-close">)</mo></math> </td><td class="td11" id="TBL-2-3-5" style="text-align:left; white-space:nowrap;"> <!--l. 1260--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>p</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>d</mi><mi>i</mi><mi>c</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-close">)</mo></math> </td>
</tr><tr id="TBL-2-4-" style="vertical-align:baseline;"><td class="td11" id="TBL-2-4-1" style="text-align:left; white-space:nowrap;"> #   </td><td class="td11" id="TBL-2-4-2" style="text-align:left; white-space:nowrap;"> …                                                                                                                                                          </td><td class="td11" id="TBL-2-4-3" style="text-align:left; white-space:nowrap;"> …                                                                                                                                                          </td><td class="td11" id="TBL-2-4-4" style="text-align:left; white-space:nowrap;"> …                                                                                                                                                          </td><td class="td11" id="TBL-2-4-5" style="text-align:left; white-space:nowrap;"> …                                                                                                                                                          </td></tr><tr id="TBL-2-5-" style="vertical-align:baseline;"><td class="td 11" id="TBL-2-5-1" style="text-align:left; white-space:nowrap;"> #   </td><td class="td11" id="TBL-2-5-2" style="text-align:left; white-space:nowrap;"> <!--l. 1262--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>m</mi><mi>i</mi><mi>n</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></mrow></msub><mo class="MathClass-close">)</mo></math> </td><td class="td11" id="TBL-2-5-3" style="text-align:left; white-space:nowrap;"> <!--l. 1262--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></mrow></msub><mo class="MathClass-close">)</mo></math> </td><td class="td11" id="TBL-2-5-4" style="text-align:left; white-space:nowrap;"> <!--l. 1262--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>n</mi><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>s</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></mrow></msub><mo class="MathClass-close">)</mo></math> </td><td class="td11" id="TBL-2-5-5" style="text-align:left; white-space:nowrap;"> <!--l. 1262--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>p</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>d</mi><mi>i</mi><mi>c</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></mrow></msub><mo class="MathClass-close">)</mo></math> </td><td class="td11" id="TBL-2-5-6" style="text-align:left; white-space:nowrap;"> </td>
</tr><tr id="TBL-2-6-" style="vertical-align:baseline;"><td class="td11" id="TBL-2-6-1" style="text-align:left; white-space:nowrap;"> </td>
</tr><tr id="TBL-2-7-" style="vertical-align:baseline;"><td class="td11" id="TBL-2-7-1" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-2-7-2" style="text-align:left; white-space:nowrap;"> <!--l. 1264--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow><mrow><mn>1</mn></mrow></msubsup></math> </td><td class="td11" id="TBL-2-7-3" style="text-align:left; white-space:nowrap;"> <!--l. 1264--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mn>1</mn></mrow></msubsup></math> </td><td class="td11" id="TBL-2-7-4" style="text-align:left; white-space:nowrap;"> …                                                                                                                                                          </td><td class="td11" id="TBL-2-7-5" style="text-align:left; white-space:nowrap;"> <!--l. 1264--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></mrow><mrow><mn>1</mn></mrow></msubsup></math> </td><td class="td11" id="TBL-2-7-6" style="text-align:left; white-space:nowrap;"> f(<!--l. 1264--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow><mrow><mn>1</mn></mrow></msubsup></math>, <!--l. 1264--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mn>1</mn></mrow></msubsup></math>, …, <!--l. 1264--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></mrow><mrow><mn>1</mn></mrow></msubsup></math>)  </td><td class="td11" id="TBL-2-7-7" style="text-align:left; white-space:nowrap;"> </td>
</tr><tr id="TBL-2-8-" style="vertical-align:baseline;"><td class="td11" id="TBL-2-8-1" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-2-8-2" style="text-align:left; white-space:nowrap;"> <!--l. 1265--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow><mrow><mn>1</mn></mrow></msubsup></math> </td><td class="td11" id="TBL-2-8-3" style="text-align:left; white-space:nowrap;"> <!--l. 1265--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mn>1</mn></mrow></msubsup></math> </td><td class="td11" id="TBL-2-8-4" style="text-align:left; white-space:nowrap;"> …                                                                                                                                                          </td><td class="td11" id="TBL-2-8-5" style="text-align:left; white-space:nowrap;"> <!--l. 1265--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></mrow><mrow><mn>2</mn></mrow></msubsup></math> </td><td class="td11" id="TBL-2-8-6" style="text-align:left; white-space:nowrap;"> f(<!--l. 1265--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow><mrow><mn>1</mn></mrow></msubsup></math>, <!--l. 1265--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mn>1</mn></mrow></msubsup></math>, …, <!--l. 1265--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></mrow><mrow><mn>2</mn></mrow></msubsup></math>)  </td></tr><tr id="TBL-2-9-" style="vertical-align:baseline;"><td class="td 11" id="TBL-2-9-1" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-2-9-2" style="text-align:left; white-space:nowrap;"> …                                                                                                                                                          </td><td class="td11" id="TBL-2-9-3" style="text-align:left; white-space:nowrap;"> …                                                                                                                                                          </td><td class="td11" id="TBL-2-9-4" style="text-align:left; white-space:nowrap;"> …                                                                                                                                                          </td><td class="td11" id="TBL-2-9-5" style="text-align:left; white-space:nowrap;"> …                                                                                                                                                          </td><td class="td11" id="TBL-2-9-6" style="text-align:left; white-space:nowrap;"> …                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr id="TBL-2-10-" style="vertical-align:baseline;"><td class="td11" id="TBL-2-10-1" style="text-align:left; white-space:nowrap;"> </td>
</tr><tr id="TBL-2-11-" style="vertical-align:baseline;"><td class="td11" id="TBL-2-11-1" style="text-align:left; white-space:nowrap;"> </td> </tr></table>
</div>
<!--l. 1270--><p class="noindent">Lines beginning with the character “<span class="ectt-1095">#</span>" are the header of the file.
<!--l. 1271--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></math>
is the number of collective variables sampled by the grid. For each variable
<!--l. 1272--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub></math>,
<!--l. 1272--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>m</mi><mi>i</mi><mi>n</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo></math>
is the lowest value sampled by the grid (i.e. the left-most boundary of the grid along
<!--l. 1272--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub></math>),
<!--l. 1272--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo></math> is the width of each
grid step along <!--l. 1272--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub></math>,
<!--l. 1272--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>n</mi><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>s</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo></math> is the number
of points and <!--l. 1272--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>p</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>d</mi><mi>i</mi><mi>c</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo></math>
is a flag whose value is 1 or 0 depending on whether the grid is periodic along
<!--l. 1272--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub></math>. In
most situations: </p>
<ul class="itemize1">
<li class="itemize"><!--l. 1275--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>m</mi><mi>i</mi><mi>n</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo></math>
     is given by the <a href="#colvar|lowerBoundary"><span class="ectt-1095">lowerBoundary</span></a> keyword of the variable <!--l. 1275--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub></math>;
     </li>
<li class="itemize"><!--l. 1276--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo></math>
     is given by the <a href="#colvar|width"><span class="ectt-1095">width</span></a> keyword;
     </li>
<li class="itemize"><!--l. 1277--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>n</mi><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>s</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo></math>
     is calculated from the two above numbers and the <a href="#colvar|upperBoundary"><span class="ectt-1095">upperBoundary</span></a> keyword;
     </li>
<li class="itemize"><!--l. 1278--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>p</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>d</mi><mi>i</mi><mi>c</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo></math>
     is set to 1 if and only if <!--l. 1278--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
     is periodic and the grids' boundaries cover its period.</li></ul>
<!--l. 1281--><p class="indent">   How the grid's boundaries affect the sequence of points depends on how the contents of the file were
computed. In many cases, such as histograms and PMFs computed by metadynamics (<a href="#sec:colvarbias_ebmeta">6.6.5<!--tex4ht:ref: sec:colvarbias_ebmeta --></a>), the values
of <!--l. 1281--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
in the first few columns correspond to the <span class="phvro8t-x-x-109">midpoints </span>of the corresponding bins,
i.e. <!--l. 1281--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow><mrow><mn>1</mn></mrow></msubsup> <mo class="MathClass-rel">=</mo> <mstyle mathvariant="monospace"><mi>m</mi><mi>i</mi><mi>n</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo><mo class="MathClass-bin">+</mo><mstyle mathvariant="monospace"><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo><mo class="MathClass-bin">∕</mo><mn>2</mn></math>.
However, there is a slightly different format in PMF files computed by ABF (<a href="#sec:colvarbias_abf">6.3<!--tex4ht:ref: sec:colvarbias_abf --></a>) or
other biases that use thermodynamic integration (<a href="#sec:colvarbias_ti">6.2<!--tex4ht:ref: sec:colvarbias_ti --></a>). In these cases, it is free-energy
gradients that are accumulated on an <span class="ectt-1095">(npoints)</span>-long grid along each variable
<!--l. 1283--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ξ</mi></math>: after these
gradients are integrated, the resulting PMF is discretized on a slightly larger grid with <span class="ectt-1095">(npoints+1) </span>points
along <!--l. 1283--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ξ</mi></math>
(unless the interval is periodic). Therefore, the grid's outer edges extend by
<!--l. 1284--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo><mo class="MathClass-bin">∕</mo><mn>2</mn></math>
above and below the specified boundaries, so that for instance
<!--l. 1284--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>m</mi><mi>i</mi><mi>n</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo></math> in the header appears
to be shifted back by <!--l. 1284--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="monospace"><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mstyle><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-close">)</mo><mo class="MathClass-bin">∕</mo><mn>2</mn></math>
                                                                                         
                                                                                         
compared to what would be expected. <span class="phvro8t-x-x-109">Please keep this difference in mind when comparing PMFs</span>
<span class="phvro8t-x-x-109">computed by different methods.</span>
</p><!--l. 1286--><p class="indent">   After the header, the rest of the file contains values of the tabulated function
<!--l. 1287--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo class="MathClass-open">(</mo><msub><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow></msub></math>,
<!--l. 1287--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><mn>2</mn></mrow></msub></math>,
…<!--l. 1287--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></mrow></msub><mo class="MathClass-close">)</mo></math>, one for each line.
The first <!--l. 1288--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></math> columns
contain values of <!--l. 1288--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><mn>1</mn></mrow></msub></math>,
<!--l. 1288--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><mn>2</mn></mrow></msub></math>,
…<!--l. 1288--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></mrow></msub></math> and the last column contains
the value of the function <!--l. 1288--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math>.
Points are sorted in ascending order with the fastest-changing values at the right (“C-style" order). Each sweep of the
right-most variable <!--l. 1290--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ξ</mi></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mi>c</mi><mi>v</mi></mstyle></mrow></msub></mrow></msub></math>
is terminated by an empty line. For two dimensional grid files, this allows quick visualization by programs
such as GNUplot. <br class="newline"/>
</p><!--l. 1294--><p class="noindent"><span class="phvb8t-x-x-109">Example 1: </span>multicolumn text file for a one-dimensional histogram with <span class="ectt-1095">lowerBoundary </span>= 15,
<span class="ectt-1095">upperBoundary </span>= 48 and <span class="ectt-1095">width </span>= 0.1.
</p>
<div class="tabular"> <table class="tabular" id="TBL-3"><colgroup id="TBL-3-1g"><col id="TBL-3-1"/><col id="TBL-3-2"/><col id="TBL-3-3"/><col id="TBL-3-4"/><col id="TBL-3-5"/><col id="TBL-3-6"/></colgroup><tr id="TBL-3-1-" style="vertical-align:baseline;"><td class="td11" id="TBL-3-1-1" style="text-align:left; white-space:nowrap;"> </td></tr><tr id="TBL-3-2-" style="vertical-align:baseline;"><td class="td11" id="TBL-3-2-1" style="text-align:left; white-space:nowrap;"> #</td><td class="td11" id="TBL-3-2-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">1     </span></td><td class="td11" id="TBL-3-2-3" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-2-4" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-2-5" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-2-6" style="text-align:left; white-space:nowrap;"> </td>
</tr><tr id="TBL-3-3-" style="vertical-align:baseline;"><td class="td11" id="TBL-3-3-1" style="text-align:left; white-space:nowrap;"> #  </td><td class="td11" id="TBL-3-3-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">15    </span></td><td class="td11" id="TBL-3-3-3" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">0.1         </span></td><td class="td11" id="TBL-3-3-4" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">330 </span></td><td class="td11" id="TBL-3-3-5" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">0 </span></td></tr><tr id="TBL-3-4-" style="vertical-align:baseline;"><td class="td11" id="TBL-3-4-1" style="text-align:left; white-space:nowrap;"> </td>
</tr><tr id="TBL-3-5-" style="vertical-align:baseline;"><td class="td11" id="TBL-3-5-1" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-5-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">15.05 </span></td><td class="td11" id="TBL-3-5-3" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">6.14012e-07 </span></td><td class="td11" id="TBL-3-5-4" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-5-5" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-5-6" style="text-align:left; white-space:nowrap;"> </td></tr><tr id="TBL-3-6-" style="vertical-align:baseline;"><td class="td11" id="TBL-3-6-1" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-3-6-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">15.15 </span></td> <td class="td11" id="TBL-3-6-3" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">7.47644e-07 </span></td> <td class="td11" id="TBL-3-6-4" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-3-6-5" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-3-6-6" style="text-align:left; white-space:nowrap;"></td>
</tr><tr id="TBL-3-7-" style="vertical-align:baseline;"><td class="td11" id="TBL-3-7-1" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-7-2" style="text-align:left; white-space:nowrap;"> …         </td><td class="td11" id="TBL-3-7-3" style="text-align:left; white-space:nowrap;"> …                     </td><td class="td11" id="TBL-3-7-4" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-7-5" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-7-6" style="text-align:left; white-space:nowrap;"> </td></tr><tr id="TBL-3-8-" style="vertical-align:baseline;"><td class="td11" id="TBL-3-8-1" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-3-8-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">47.85 </span></td> <td class="td11" id="TBL-3-8-3" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">1.65944e-06 </span></td> <td class="td11" id="TBL-3-8-4" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-3-8-5" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-3-8-6" style="text-align:left; white-space:nowrap;"></td>
</tr><tr id="TBL-3-9-" style="vertical-align:baseline;"><td class="td11" id="TBL-3-9-1" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-9-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">47.95 </span></td><td class="td11" id="TBL-3-9-3" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">1.46712e-06 </span></td><td class="td11" id="TBL-3-9-4" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-9-5" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-3-9-6" style="text-align:left; white-space:nowrap;"> </td></tr><tr id="TBL-3-10-" style="vertical-align:baseline;"><td class="td11" id="TBL-3-10-1" style="text-align:left; white-space:nowrap;"> </td>
</tr><tr id="TBL-3-11-" style="vertical-align:baseline;"><td class="td11" id="TBL-3-11-1" style="text-align:left; white-space:nowrap;"> </td> </tr></table></div>
<!--l. 1309--><p class="noindent"><span class="phvb8t-x-x-109">Example 2: </span>multicolumn text file for a two-dimensional histogram of two dihedral angles (periodic interval
with 6<!--l. 1309--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow></mrow><mrow><mo class="MathClass-bin">∘</mo></mrow></msup></math>
bins):
</p>
<div class="tabular"> <table class="tabular" id="TBL-4"><colgroup id="TBL-4-1g"><col id="TBL-4-1"/><col id="TBL-4-2"/><col id="TBL-4-3"/><col id="TBL-4-4"/><col id="TBL-4-5"/><col id="TBL-4-6"/></colgroup><tr id="TBL-4-1-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-1-1" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-4-1-2" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-4-1-3" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-4-1-4" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-4-1-5" style="text-align:left; white-space:nowrap;"> </td></tr><tr id="TBL-4-2-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-2-1" style="text-align:left; white-space:nowrap;"> # </td> <td class="td11" id="TBL-4-2-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">2 </span></td> <td class="td11" id="TBL-4-2-3" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-4-2-4" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-4-2-5" style="text-align:left; white-space:nowrap;"></td><td class="td11" id="TBL-4-2-6" style="text-align:left; white-space:nowrap;"> </td>
</tr><tr id="TBL-4-3-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-3-1" style="text-align:left; white-space:nowrap;"> #  </td><td class="td11" id="TBL-4-3-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">-180.0 </span></td><td class="td11" id="TBL-4-3-3" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">6.0    </span></td><td class="td11" id="TBL-4-3-4" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">30          </span></td><td class="td11" id="TBL-4-3-5" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">1 </span></td></tr><tr id="TBL-4-4-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-4-1" style="text-align:left; white-space:nowrap;"> # </td> <td class="td11" id="TBL-4-4-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">-180.0 </span></td> <td class="td11" id="TBL-4-4-3" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">6.0 </span></td> <td class="td11" id="TBL-4-4-4" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">30 </span></td> <td class="td11" id="TBL-4-4-5" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">1</span></td>
</tr><tr id="TBL-4-5-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-5-1" style="text-align:left; white-space:nowrap;"> </td></tr><tr id="TBL-4-6-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-6-1" style="text-align:left; white-space:nowrap;"></td><td class="td11" id="TBL-4-6-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">-177.0 </span></td><td class="td11" id="TBL-4-6-3" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">-177.0 </span></td><td class="td11" id="TBL-4-6-4" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">8.97117e-06 </span></td><td class="td11" id="TBL-4-6-5" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-4-6-6" style="text-align:left; white-space:nowrap;"> </td>
</tr><tr id="TBL-4-7-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-7-1" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-4-7-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">-177.0 </span></td><td class="td11" id="TBL-4-7-3" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">-171.0 </span></td><td class="td11" id="TBL-4-7-4" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">1.53525e-06 </span></td><td class="td11" id="TBL-4-7-5" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-4-7-6" style="text-align:left; white-space:nowrap;"> </td></tr><tr id="TBL-4-8-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-8-1" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-4-8-2" style="text-align:left; white-space:nowrap;"> … </td> <td class="td11" id="TBL-4-8-3" style="text-align:left; white-space:nowrap;"> … </td> <td class="td11" id="TBL-4-8-4" style="text-align:left; white-space:nowrap;"> … </td> <td class="td11" id="TBL-4-8-5" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-4-8-6" style="text-align:left; white-space:nowrap;"></td>
</tr><tr id="TBL-4-9-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-9-1" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-4-9-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">-177.0 </span></td><td class="td11" id="TBL-4-9-3" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">177.0 </span></td><td class="td11" id="TBL-4-9-4" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">2.442956-06 </span></td><td class="td11" id="TBL-4-9-5" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-4-9-6" style="text-align:left; white-space:nowrap;"> </td></tr><tr id="TBL-4-10-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-10-1" style="text-align:left; white-space:nowrap;"> </td>
</tr><tr id="TBL-4-11-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-11-1" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-4-11-2" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">-171.0 </span></td><td class="td11" id="TBL-4-11-3" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">-177.0 </span></td><td class="td11" id="TBL-4-11-4" style="text-align:left; white-space:nowrap;"> <span class="ectt-1095">2.04702e-05 </span></td><td class="td11" id="TBL-4-11-5" style="text-align:left; white-space:nowrap;"> </td><td class="td11" id="TBL-4-11-6" style="text-align:left; white-space:nowrap;"> </td></tr><tr id="TBL-4-12-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-12-1" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-4-12-2" style="text-align:left; white-space:nowrap;"> … </td> <td class="td11" id="TBL-4-12-3" style="text-align:left; white-space:nowrap;"> … </td> <td class="td11" id="TBL-4-12-4" style="text-align:left; white-space:nowrap;"> … </td> <td class="td11" id="TBL-4-12-5" style="text-align:left; white-space:nowrap;"> </td> <td class="td11" id="TBL-4-12-6" style="text-align:left; white-space:nowrap;"></td>
</tr><tr id="TBL-4-13-" style="vertical-align:baseline;"><td class="td11" id="TBL-4-13-1" style="text-align:left; white-space:nowrap;"> </td> </tr></table></div>
<div class="flushright">
<!--l. 1327--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1327--><p class="noindent"> </p><div class="heading"> <a id="sec:colvars_traj_format"></a>
<h5 class="subsubsectionHead"><span class="titlemark">3.8.5    </span> <a id="sec:colvars_traj_format"></a>Output trajectory files</h5>
<!--l. 1327--><p class="noindent"></p></div>
<!--l. 1329--><p class="indent">   The Colvars trajectory file (with a suffix <span class="ectt-1095">.colvars.traj</span>) is a plain text file (scientific
notation with 14-digit precision) whose columns represent quantities such as colvar
values, applied forces, or individual restraints' energies. Under most scenarios, plotting
or analyzing this file is straightforward: for example, the following contains a variable
“<!--l. 1329--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math>" and the energy
of a restraint “<!--l. 1329--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>A</mi></math>":</p>
<div class="mdframed" id="mdframed-38">
<!--l. 1330--><p class="noindent"></p><pre>#       step   A                     E_rA<br class="newline"/>           0    1.42467449615693e+01  6.30982865292123e+02<br class="newline"/>         100    1.42282559728026e+01  6.20640585041317e+02<br class="newline"/>…</pre><!--l. 1335--><p class="noindent"></p>
</div>
<!--l. 1337--><p class="indent">   Occasionally, if the Colvars configuration is changed mid-run certain quantities may be
added or removed, changing the column layout. Labels in comment lines can assist in such
cases: for example, consider the trajectory above with the addition of a second variable,
“<!--l. 1337--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math>", after
10,000 steps:</p>
<div class="mdframed" id="mdframed-39">
<!--l. 1338--><p class="noindent"></p><pre>#       step   A                     E_rA<br class="newline"/>           0    1.42467449615693e+01  6.30982865292123e+02<br class="newline"/>         100    1.42282559728026e+01  6.20640585041317e+02<br class="newline"/>…<br class="newline"/>#       step   A                     B                     E_rA              <br class="newline"/>       10000    1.38136915830229e+01  9.99574098859265e-01  4.11184644791030e+02<br class="newline"/>       10100    1.36437184346326e+01  9.99574091957314e-01  3.37726286543895e+02
</pre><!--l. 1346--><p class="noindent"></p>
</div>
<!--l. 1348--><p class="indent">   Analyzing the above file with standard tools is possible, but laborious: a <a href="https://github.com/Colvars/colvars/blob/master/colvartools/plot_colvars_traj.py?raw=true">convenience script</a> is provided
for this and related purposes. It may be used either as a command-line tool or as a Python
module:</p>
<div class="mdframed" id="mdframed-40">
<!--l. 1349--><p class="noindent"></p><pre>&gt;&gt;&gt; from plot_colvars_traj import Colvars_traj<br class="newline"/>&gt;&gt;&gt; traj = Colvars_traj('test.colvars.traj')<br class="newline"/>&gt;&gt;&gt; print(traj['A'].steps, traj['A'].values)<br class="newline"/>[    0   100  ...  10000 10100] [14.246745 14.228256 ... 13.813692 13.643718]<br class="newline"/>&gt;&gt;&gt; print(traj['B'].steps, traj['B'].values)<br class="newline"/>[10000 10100] [0.999574  0.9995741] </pre><!--l. 1356--><p class="noindent"></p>
</div>
<!--l. 1359--><p class="indent">
</p>
<div class="flushright">
<!--l. 1359--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1359--><p class="noindent"> </p><div class="heading"> <a id="sec:colvar"></a>
<h3 class="sectionHead"><span class="titlemark">4    </span> <a id="sec:colvar"></a>Defining collective variables</h3>
<!--l. 1359--><p class="noindent"></p></div>
<!--l. 1361--><p class="indent">   A collective variable is defined by the keyword <span class="ectt-1095">colvar </span>followed by its configuration options contained
within curly braces:</p>
<div class="mdframed" id="mdframed-41">
<!--l. 1363--><p class="noindent"></p><pre>colvar {<br class="newline"/>  name xi<br class="newline"/>  <!--l. 1366--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math>other options<!--l. 1366--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math><br class="newline"/>  function_name {<br class="newline"/>    <!--l. 1368--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math>parameters<!--l. 1368--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math><br class="newline"/>    <!--l. 1369--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&lt;</mo></math>atom selection<!--l. 1369--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <mo class="MathClass-rel">&gt;</mo></math><br class="newline"/>  }<br class="newline"/>} </pre><!--l. 1372--><p class="noindent"></p>
</div>
<!--l. 1375--><p class="noindent">There are multiple ways of defining a variable: </p>
<ul class="itemize1">
<li class="itemize">The <span class="phvro8t-x-x-109">simplest and most common way  </span>way is using one of the precompiled functions (here
     called “components"), which are listed in section <a href="#sec:cvc_list">4.1<!--tex4ht:ref: sec:cvc_list --></a>. For example, using the keyword <span class="ectt-1095">rmsd</span>
     (section  <a href="#sec:cvc_rmsd">4.6.1<!--tex4ht:ref: sec:cvc_rmsd --></a>)  defines  the  variable  as  the  root  mean  squared  deviation  (RMSD)  of  the
     selected atoms.
     </li>
<li class="itemize">A  new  variable  may  also  be  constructed  as  a  linear  or  polynomial  combination  of  the
     components listed in section <a href="#sec:cvc_list">4.1<!--tex4ht:ref: sec:cvc_list --></a> (see <a href="#sec:cvc_superp">4.17<!--tex4ht:ref: sec:cvc_superp --></a> for details).
     </li>
<li class="itemize">A user-defined mathematical function of the existing components (see list in section <a href="#sec:cvc_list">4.1<!--tex4ht:ref: sec:cvc_list --></a>),
     or of the atomic coordinates directly (see the <span class="ectt-1095">cartesian </span>keyword in <a href="#sec:cvc_cartesian">4.9.1<!--tex4ht:ref: sec:cvc_cartesian --></a>). The function is
     defined through the keyword <a href="#colvar|customFunction"><span class="ectt-1095">customFunction</span></a> (see <a href="#sec:colvar_custom_function">4.18<!--tex4ht:ref: sec:colvar_custom_function --></a> for details). </li></ul>
<!--l. 1388--><p class="noindent">Choosing a component (function) is the only parameter strictly required to define a collective variable. It is
also highly recommended to specify a name for the variable: </p>
<ul class="itemize1">
<li class="itemize"><a id="colvar|name"></a> <span class="colorbox" id="colorbox12"><a id="dx1-29001"></a><span class="ectt-1095">name</span></span> — <span class="phvro8t-x-x-109">Name of this colvar</span><br class="newline"/>Default: “<span class="ectt-1095">colvar</span>" + numeric id <!--l. 1403--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-open">[</mo></math> string,
     context: <span class="ectt-1095">colvar</span> <!--l. 1403--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mo class="MathClass-close">]</mo></math><br class="newline"/>The name is an unique case-sensitive string which allows the Colvars module to identify this
     colvar unambiguously; it is also used in the trajectory file to label to the columns corresponding
     to this colvar.
     </li></ul>
<div class="flushright">
<!--l. 1408--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1408--><p class="noindent"> </p><div class="heading"> <a id="sec:cvc_list"></a>
<h4 class="subsectionHead"><span class="titlemark">4.1    </span> <a id="sec:cvc_list"></a>Choosing a function</h4>
<!--l. 1408--><p class="noindent"></p></div>
<!--l. 1410--><p class="indent">   In this context, the function that computes a colvar is called a <span class="phvro8t-x-x-109">component</span>. A component's choice
and definition consists of including in the variable's configuration a keyword indicating the
type of function (e.g. <span class="ectt-1095">rmsd</span>), followed by a definition block specifying the atoms involved (see
<a href="#sec:colvar_atom_groups">5<!--tex4ht:ref: sec:colvar_atom_groups --></a>) and any additional parameters (cutoffs, “reference" values, …). <span class="phvro8t-x-x-109">At least one component</span>
<span class="phvro8t-x-x-109">must be chosen to define a variable: </span>if none of the keywords listed below is found, an error is
raised.
</p><!--l. 1414--><p class="indent">   The following components implement functions with a scalar value (i.e. a real number):
</p>
<ul class="itemize1">
<li class="itemize"><a href="#colvar|distance"><span class="ectt-1095">distance</span></a>: distance between two groups;
     </li>
<li class="itemize"><a href="#colvar|distanceZ"><span class="ectt-1095">distanceZ</span></a>: projection of a distance vector on an axis;
     </li>
<li class="itemize"><a href="#colvar|distanceXY"><span class="ectt-1095">distanceXY</span></a>: projection of a distance vector on a plane;
     </li>
<li class="itemize"><a href="#colvar|distanceInv"><span class="ectt-1095">distanceInv</span></a>: mean distance between two groups of atoms (e.g. NOE-based distance);
     </li>
<li class="itemize"><a href="#colvar|angle"><span class="ectt-1095">angle</span></a>: angle between three groups;
     </li>
<li class="itemize"><a href="#colvar|dihedral"><span class="ectt-1095">dihedral</span></a>: torsional (dihedral) angle between four groups;
     </li>
<li class="itemize"><a href="#colvar|dipoleAngle"><span class="ectt-1095">dipoleAngle</span></a>: angle between two groups and dipole of a third group;
     </li>
<li class="itemize"><a href="#colvar|dipoleMagnitude"><span class="ectt-1095">dipoleMagnitude</span></a>: magnitude of the dipole of a group of atoms;
     </li>
<li class="itemize"><a href="#colvar|polarTheta"><span class="ectt-1095">polarTheta</span></a>: polar angle of a group in spherical coordinates;
                                                                                         
                                                                                         
     </li>
<li class="itemize"><a href="#colvar|polarPhi"><span class="ectt-1095">polarPhi</span></a>: azimuthal angle of a group in spherical coordinates;
     </li>
<li class="itemize"><a href="#colvar|eulerPhi"><span class="ectt-1095">eulerPhi</span></a>: Roll angle of rotation from references coordinates;
     </li>
<li class="itemize"><a href="#colvar|eulerTheta"><span class="ectt-1095">eulerTheta</span></a>: Pitch angle of rotation from references coordinates;
     </li>
<li class="itemize"><a href="#colvar|eulerPsi"><span class="ectt-1095">eulerPsi</span></a>: Yaw angle of rotation from references coordinates;
     </li>
<li class="itemize"><a href="#colvar|coordNum"><span class="ectt-1095">coordNum</span></a>: coordination number between two groups;
     </li>
<li class="itemize"><a href="#colvar|selfCoordNum"><span class="ectt-1095">selfCoordNum</span></a>: coordination number of atoms within a group;
     </li>
<li class="itemize"><a href="#colvar|hBond"><span class="ectt-1095">hBond</span></a>: hydrogen bond between two atoms;
     </li>
<li class="itemize"><a href="#colvar|rmsd"><span class="ectt-1095">rmsd</span></a>: root mean square deviation (RMSD) from a set of reference coordinates;
     </li>
<li class="itemize"><a href="#colvar|eigenvector"><span class="ectt-1095">eigenvector</span></a>: projection of the atomic coordinates on a vector;
     </li>
<li class="itemize"><a href="#colvar|orientationAngle"><span class="ectt-1095">orientationAngle</span></a>: angle of the best-fit rotation from a set of reference coordinates;
     </li>
<li class="itemize"><a href="#colvar|orientationProj"><span class="ectt-1095">orientationProj</span></a>: cosine of <a href="#colvar|orientationProj"><span class="ectt-1095">orientationProj</span></a>;
     </li>
<li class="itemize"><a href="#colvar|spinAngle"><span class="ectt-1095">spinAngle</span></a>: projection orthogonal to an axis of the best-fit rotation from a set of reference
     coordinates;
     </li>
<li class="itemize"><a href="#colvar|tilt"><span class="ectt-1095">tilt</span></a>: projection on an axis of the best-fit rotation from a set of reference coordinates;
     </li>
<li class="itemize"><a href="#colvar|gyration"><span class="ectt-1095">gyration</span></a>: radius of gyration of a group of atoms;
     </li>
<li class="itemize"><a href="#colvar|inertia"><span class="ectt-1095">inertia</span></a>: moment of inertia of a group of atoms;
     </li>
<li class="itemize"><a href="#colvar|inertiaZ"><span class="ectt-1095">inertiaZ</span></a>: moment of inertia of a group of atoms around a chosen axis;
     </li>
<li class="itemize"><a href="#colvar|alpha"><span class="ectt-1095">alpha</span></a>: <!--l. 1448--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math>-helix
     content of a protein segment.
                                                                                         
                                                                                         
     </li>
<li class="itemize"><a href="#colvar|dihedralPC"><span class="ectt-1095">dihedralPC</span></a>: projection of protein backbone dihedrals onto a dihedral principal component. </li></ul>
<!--l. 1456--><p class="indent">   Some components do not return scalar, but vector values: </p>
<ul class="itemize1">
<li class="itemize"><a href="#colvar|distanceVec"><span class="ectt-1095">distanceVec</span></a>: distance vector between two groups (length: 3);
     </li>
<li class="itemize"><a href="#colvar|distanceDir"><span class="ectt-1095">distanceDir</span></a>: unit vector parallel to distanceVec (length: 3);
     </li>
<li class="itemize"><a href="#colvar|cartesian"><span class="ectt-1095">cartesian</span></a>: vector of atomic Cartesian coordinates (length: <!--l. 1460--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>
     times the number of Cartesian components requested, X, Y or Z);
     </li>
<li class="itemize"><a href="#colvar|distancePairs"><span class="ectt-1095">distancePairs</span></a>: vector of mutual distances (length: <!--l. 1461--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mn>1</mn></mstyle></mrow></msub> <mo class="MathClass-bin">×</mo><msub><mrow><mi>N</mi></mrow><mrow><mstyle mathvariant="normal"><mn>2</mn></mstyle></mrow></msub></math>);
     </li>
<li class="itemize"><a href="#colvar|orientation"><span class="ectt-1095">orientation</span></a>: best-fit rotation, expressed as a unit quaternion (length: 4).</li></ul>
<!--l. 1465--><p class="indent">   The types of components used in a colvar (scalar or not) determine the properties of that colvar, and
particularly which biasing or analysis methods can be applied.
</p><!--l. 1469--><p class="indent"> <span class="phvb8t-x-x-109">What if “X" is not listed? </span>If a function type is not available on this list, it may be possible to
define it as a polynomial superposition of existing ones (see <a href="#sec:cvc_superp">4.17<!--tex4ht:ref: sec:cvc_superp --></a>), a custom function (see
<a href="#sec:colvar_custom_function">4.18<!--tex4ht:ref: sec:colvar_custom_function --></a>).
</p><!--l. 1471--><p class="indent">   In the rest of this section, all available component types are listed, along with their physical units and
their ranges of values, if limited. Such ranges are often used to define automatically default sampling
intervals, for example by setting the parameters <a href="#colvar|lowerBoundary"><span class="ectt-1095">lowerBoundary</span></a> and <a href="#colvar|upperBoundary"><span class="ectt-1095">upperBoundary</span></a> in the parent
colvar.
</p><!--l. 1474--><p class="indent">   For each type of component, the available configurations keywords are listed: when two components
share certain keywords, the second component references to the documentation of the first one that uses
that keyword. The very few keywords that are available for all types of components are listed in a separate
section <a href="#sec:cvc_common">4.14<!--tex4ht:ref: sec:cvc_common --></a>.
</p>
<div class="flushright">
<!--l. 1480--><p class="noindent">
<a href="#sec:toc" style="text-decoration: none; background-color: white; color: gray;">(Go to Contents)</a><br/></p></div>
<!--l. 1480--><p class="noindent"> </p><div class="heading"> <a id="sec:cvc_pbcs"></a>
<h4 class="subsectionHead"><span class="titlemark">4.2    </span> <a id="sec:cvc_pbcs"></a>Treatment of periodic boundary conditions</h4>
<!--l. 1480--><p class="noindent"></p></div>
<!--l. 1482--><p class="indent">   In all colvar components described below, the following rules apply concerning periodic boundary
conditions (PBCs):
                                                                                         
                                                                                         
     </p><ol class="enumerate1">
<li class="enumerate" id="x1-31002x1">Distance vectors between two coordinates <!--l. 1486--><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mstyle mathvariant="bold"><mi>d</mi></mstyle></mrow><mrow><mi>i</mi><mo class="MathClass-punc">,</mo><mi>j</mi></mrow></msub> <mo class="MathClass-rel">=</mo> <mrow><mo fence="true" form="prefix"> (</mo><mrow><msub><mrow><mstyle mathvariant="bold"><mi></mi></mstyle></mrow></msub></mrow></mrow></math></li></ol></div></div></body></html>