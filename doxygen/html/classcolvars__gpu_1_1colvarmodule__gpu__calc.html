<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Collective Variables Module - Developer Documentation: colvars_gpu::colvarmodule_gpu_calc Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Collective Variables Module - Developer Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>colvars_gpu</b></li><li class="navelem"><a class="el" href="classcolvars__gpu_1_1colvarmodule__gpu__calc.html">colvarmodule_gpu_calc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classcolvars__gpu_1_1colvarmodule__gpu__calc-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">colvars_gpu::colvarmodule_gpu_calc Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class for managing the GPU calculation of CVCs.  
 <a href="classcolvars__gpu_1_1colvarmodule__gpu__calc.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="colvar__gpu__calc_8h_source.html">colvar_gpu_calc.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for colvars_gpu::colvarmodule_gpu_calc:</div>
<div class="dyncontent">
<div class="center"><img src="classcolvars__gpu_1_1colvarmodule__gpu__calc__coll__graph.png" border="0" usemap="#acolvars__gpu_1_1colvarmodule__gpu__calc_coll__map" alt="Collaboration graph"/></div>
<map name="acolvars__gpu_1_1colvarmodule__gpu__calc_coll__map" id="acolvars__gpu_1_1colvarmodule__gpu__calc_coll__map">
<area shape="rect" title="Class for managing the GPU calculation of CVCs." alt="" coords="365,152,541,192"/>
<area shape="rect" href="classcolvars__gpu_1_1colvarmodule__gpu__calc_1_1compute__gpu__graph__t.html" title="A struct for holding a CUDA graph and its execution object." alt="" coords="5,34,181,89"/>
<area shape="rect" href="classcolvars__gpu_1_1colvar__nvtx__prof.html" title="Class for managing NVTX profiling ranges." alt="" coords="26,263,161,303"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcolvars__gpu_1_1colvarmodule__gpu__calc_1_1compute__gpu__graph__t.html">compute_gpu_graph_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A struct for holding a CUDA graph and its execution object.  <a href="classcolvars__gpu_1_1colvarmodule__gpu__calc_1_1compute__gpu__graph__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcolvars__gpu_1_1colvarmodule__gpu__calc_1_1compute__node__t.html">compute_node_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A struct for holding a compute node in the CUDA graph and its corresponding atom group or CVC (child of colvardeps)  <a href="structcolvars__gpu_1_1colvarmodule__gpu__calc_1_1compute__node__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a96664b0298477a46705b1b5762944861"><td class="memItemLeft" align="right" valign="top"><a id="a96664b0298477a46705b1b5762944861" name="a96664b0298477a46705b1b5762944861"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>colvarmodule_gpu_calc</b> ()</td></tr>
<tr class="memdesc:a96664b0298477a46705b1b5762944861"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. <br /></td></tr>
<tr class="separator:a96664b0298477a46705b1b5762944861"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85868d7785f36a3cb947a643e7324ced"><td class="memItemLeft" align="right" valign="top"><a id="a85868d7785f36a3cb947a643e7324ced" name="a85868d7785f36a3cb947a643e7324ced"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>~colvarmodule_gpu_calc</b> ()</td></tr>
<tr class="memdesc:a85868d7785f36a3cb947a643e7324ced"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a85868d7785f36a3cb947a643e7324ced"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeff40fbc0f5db83a6e0d700db064b164"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcolvars__gpu_1_1colvarmodule__gpu__calc.html#aeff40fbc0f5db83a6e0d700db064b164">init</a> ()</td></tr>
<tr class="memdesc:aeff40fbc0f5db83a6e0d700db064b164"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize all the GPU compute graphs.  <a href="classcolvars__gpu_1_1colvarmodule__gpu__calc.html#aeff40fbc0f5db83a6e0d700db064b164">More...</a><br /></td></tr>
<tr class="separator:aeff40fbc0f5db83a6e0d700db064b164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93755e061e215662783b8cb7ad9d70da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcolvars__gpu_1_1colvarmodule__gpu__calc.html#a93755e061e215662783b8cb7ad9d70da">calc_cvs</a> (const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;colvars, <a class="el" href="classcolvarmodule.html">colvarmodule</a> *colvar_module)</td></tr>
<tr class="memdesc:a93755e061e215662783b8cb7ad9d70da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the <code>colvar {...}</code> blocks.  <a href="classcolvars__gpu_1_1colvarmodule__gpu__calc.html#a93755e061e215662783b8cb7ad9d70da">More...</a><br /></td></tr>
<tr class="separator:a93755e061e215662783b8cb7ad9d70da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1dad1c8031560f94be4a2ac2b9fd44a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcolvars__gpu_1_1colvarmodule__gpu__calc.html#aa1dad1c8031560f94be4a2ac2b9fd44a">apply_forces</a> (const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;colvars, <a class="el" href="classcolvarmodule.html">colvarmodule</a> *colvar_module)</td></tr>
<tr class="memdesc:aa1dad1c8031560f94be4a2ac2b9fd44a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the forces to the atom groups from the CVCs.  <a href="classcolvars__gpu_1_1colvarmodule__gpu__calc.html#aa1dad1c8031560f94be4a2ac2b9fd44a">More...</a><br /></td></tr>
<tr class="separator:aa1dad1c8031560f94be4a2ac2b9fd44a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Internal functions used in calc_cvs()</div></td></tr>
<tr class="memitem:a202418ae51486536c7691447587b9ebc"><td class="memItemLeft" align="right" valign="top"><a id="a202418ae51486536c7691447587b9ebc" name="a202418ae51486536c7691447587b9ebc"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>cv_update_flags</b> (const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;colvars)</td></tr>
<tr class="separator:a202418ae51486536c7691447587b9ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af70c5d70c1bca0ca82b8941f1d9b9169"><td class="memItemLeft" align="right" valign="top"><a id="af70c5d70c1bca0ca82b8941f1d9b9169" name="af70c5d70c1bca0ca82b8941f1d9b9169"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>cvc_calc_total_force</b> (const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;colvars, <a class="el" href="classcolvarmodule.html">colvarmodule</a> *colvar_module, bool use_current_step=false)</td></tr>
<tr class="separator:af70c5d70c1bca0ca82b8941f1d9b9169"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2974ce2619126a7321ec4738b9c70e7"><td class="memItemLeft" align="right" valign="top"><a id="ab2974ce2619126a7321ec4738b9c70e7" name="ab2974ce2619126a7321ec4738b9c70e7"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>atom_group_read_data_gpu</b> (const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;colvars, <a class="el" href="classcolvars__gpu_1_1colvarmodule__gpu__calc_1_1compute__gpu__graph__t.html">colvarmodule_gpu_calc::compute_gpu_graph_t</a> &amp;g, <a class="el" href="classcolvarmodule.html">colvarmodule</a> *colvar_module)</td></tr>
<tr class="separator:ab2974ce2619126a7321ec4738b9c70e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b0efdb12bc3c094ea856d21e68e9a74"><td class="memItemLeft" align="right" valign="top"><a id="a9b0efdb12bc3c094ea856d21e68e9a74" name="a9b0efdb12bc3c094ea856d21e68e9a74"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>cvc_calc_value</b> (const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;colvars, <a class="el" href="classcolvarmodule.html">colvarmodule</a> *colvar_module)</td></tr>
<tr class="separator:a9b0efdb12bc3c094ea856d21e68e9a74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77bead896c6b6bc812b4780d26a2e46d"><td class="memItemLeft" align="right" valign="top"><a id="a77bead896c6b6bc812b4780d26a2e46d" name="a77bead896c6b6bc812b4780d26a2e46d"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>cvc_calc_gradients</b> (const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;colvars, <a class="el" href="classcolvarmodule.html">colvarmodule</a> *colvar_module)</td></tr>
<tr class="separator:a77bead896c6b6bc812b4780d26a2e46d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74e7907a131545d668b78eacc9c5c1d3"><td class="memItemLeft" align="right" valign="top"><a id="a74e7907a131545d668b78eacc9c5c1d3" name="a74e7907a131545d668b78eacc9c5c1d3"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>atom_group_calc_fit_gradients</b> (const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;colvars, <a class="el" href="classcolvars__gpu_1_1colvarmodule__gpu__calc_1_1compute__gpu__graph__t.html">colvarmodule_gpu_calc::compute_gpu_graph_t</a> &amp;g, <a class="el" href="classcolvarmodule.html">colvarmodule</a> *colvar_module)</td></tr>
<tr class="separator:a74e7907a131545d668b78eacc9c5c1d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdcadead03d8a01b8b35083df000471c"><td class="memItemLeft" align="right" valign="top"><a id="abdcadead03d8a01b8b35083df000471c" name="abdcadead03d8a01b8b35083df000471c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>cvc_debug_gradients</b> (const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;colvars, <a class="el" href="classcolvarmodule.html">colvarmodule</a> *colvar_module)</td></tr>
<tr class="separator:abdcadead03d8a01b8b35083df000471c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6ab1c1057619ee65724c0de981fe63c"><td class="memItemLeft" align="right" valign="top"><a id="ac6ab1c1057619ee65724c0de981fe63c" name="ac6ab1c1057619ee65724c0de981fe63c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>cvc_calc_Jacobian_derivative</b> (const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;colvars, <a class="el" href="classcolvarmodule.html">colvarmodule</a> *colvar_module)</td></tr>
<tr class="separator:ac6ab1c1057619ee65724c0de981fe63c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e37de1e9ab2c378b05f9139e52ef14"><td class="memItemLeft" align="right" valign="top"><a id="ac0e37de1e9ab2c378b05f9139e52ef14" name="ac0e37de1e9ab2c378b05f9139e52ef14"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>cv_collect_cvc_data</b> (const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;colvars, <a class="el" href="classcolvarmodule.html">colvarmodule</a> *colvar_module)</td></tr>
<tr class="separator:ac0e37de1e9ab2c378b05f9139e52ef14"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a4e7c87322fa56f1d3db3a72e4349be46"><td class="memItemLeft" align="right" valign="top"><a id="a4e7c87322fa56f1d3db3a72e4349be46" name="a4e7c87322fa56f1d3db3a72e4349be46"></a>
<a class="el" href="classcolvars__gpu_1_1colvarmodule__gpu__calc_1_1compute__gpu__graph__t.html">compute_gpu_graph_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>read_data_compute</b></td></tr>
<tr class="memdesc:a4e7c87322fa56f1d3db3a72e4349be46"><td class="mdescLeft">&#160;</td><td class="mdescRight">CUDA graph for reading data to GPU and calculating required properties. <br /></td></tr>
<tr class="separator:a4e7c87322fa56f1d3db3a72e4349be46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4811436ff0bbc673941ae5e019740bd7"><td class="memItemLeft" align="right" valign="top"><a id="a4811436ff0bbc673941ae5e019740bd7" name="a4811436ff0bbc673941ae5e019740bd7"></a>
<a class="el" href="classcolvars__gpu_1_1colvarmodule__gpu__calc_1_1compute__gpu__graph__t.html">compute_gpu_graph_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>calc_fit_gradients_compute</b></td></tr>
<tr class="memdesc:a4811436ff0bbc673941ae5e019740bd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">CUDA graph for calculating fit gradients. <br /></td></tr>
<tr class="separator:a4811436ff0bbc673941ae5e019740bd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af33a7a0ad51fc12c3f6444c0fdbd42ef"><td class="memItemLeft" align="right" valign="top"><a id="af33a7a0ad51fc12c3f6444c0fdbd42ef" name="af33a7a0ad51fc12c3f6444c0fdbd42ef"></a>
<a class="el" href="classcolvars__gpu_1_1colvarmodule__gpu__calc_1_1compute__gpu__graph__t.html">compute_gpu_graph_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>apply_forces_compute</b></td></tr>
<tr class="memdesc:af33a7a0ad51fc12c3f6444c0fdbd42ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">CUDA graph for applying forces to atom groups. <br /></td></tr>
<tr class="separator:af33a7a0ad51fc12c3f6444c0fdbd42ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1597ec819e84ed6ed925e160f09c6e8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classcolvardeps.html">colvardeps</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcolvars__gpu_1_1colvarmodule__gpu__calc.html#aa1597ec819e84ed6ed925e160f09c6e8">forced_atom_groups</a></td></tr>
<tr class="memdesc:aa1597ec819e84ed6ed925e160f09c6e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">A list of atom groups that require forces to be applied.  <a href="classcolvars__gpu_1_1colvarmodule__gpu__calc.html#aa1597ec819e84ed6ed925e160f09c6e8">More...</a><br /></td></tr>
<tr class="separator:aa1597ec819e84ed6ed925e160f09c6e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Timers for profiling</div></td></tr>
<tr class="memitem:a9d316f7917f53225c86b98c579f5cc0d"><td class="memItemLeft" align="right" valign="top"><a id="a9d316f7917f53225c86b98c579f5cc0d" name="a9d316f7917f53225c86b98c579f5cc0d"></a>
<a class="el" href="classcolvars__gpu_1_1colvar__nvtx__prof.html">colvars_gpu::colvar_nvtx_prof</a>&#160;</td><td class="memItemRight" valign="bottom"><b>ag_read_data_prof</b></td></tr>
<tr class="separator:a9d316f7917f53225c86b98c579f5cc0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a463471620342ae39dd98320f2cc2d531"><td class="memItemLeft" align="right" valign="top"><a id="a463471620342ae39dd98320f2cc2d531" name="a463471620342ae39dd98320f2cc2d531"></a>
<a class="el" href="classcolvars__gpu_1_1colvar__nvtx__prof.html">colvars_gpu::colvar_nvtx_prof</a>&#160;</td><td class="memItemRight" valign="bottom"><b>cvc_calc_value_prof</b></td></tr>
<tr class="separator:a463471620342ae39dd98320f2cc2d531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e97404eb2385a98e7225708871addb"><td class="memItemLeft" align="right" valign="top"><a id="ac0e97404eb2385a98e7225708871addb" name="ac0e97404eb2385a98e7225708871addb"></a>
<a class="el" href="classcolvars__gpu_1_1colvar__nvtx__prof.html">colvars_gpu::colvar_nvtx_prof</a>&#160;</td><td class="memItemRight" valign="bottom"><b>cvc_calc_gradients_prof</b></td></tr>
<tr class="separator:ac0e97404eb2385a98e7225708871addb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32994ccaca1679ae4c588e8505887cc6"><td class="memItemLeft" align="right" valign="top"><a id="a32994ccaca1679ae4c588e8505887cc6" name="a32994ccaca1679ae4c588e8505887cc6"></a>
<a class="el" href="classcolvars__gpu_1_1colvar__nvtx__prof.html">colvars_gpu::colvar_nvtx_prof</a>&#160;</td><td class="memItemRight" valign="bottom"><b>ag_calc_fit_gradients_prof</b></td></tr>
<tr class="separator:a32994ccaca1679ae4c588e8505887cc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3518e437578b7df8bcce93807664fc9a"><td class="memItemLeft" align="right" valign="top"><a id="a3518e437578b7df8bcce93807664fc9a" name="a3518e437578b7df8bcce93807664fc9a"></a>
<a class="el" href="classcolvars__gpu_1_1colvar__nvtx__prof.html">colvars_gpu::colvar_nvtx_prof</a>&#160;</td><td class="memItemRight" valign="bottom"><b>cvc_calc_Jacobian_derivative_prof</b></td></tr>
<tr class="separator:a3518e437578b7df8bcce93807664fc9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12003a6c5b8d4561f64d39055e62faea"><td class="memItemLeft" align="right" valign="top"><a id="a12003a6c5b8d4561f64d39055e62faea" name="a12003a6c5b8d4561f64d39055e62faea"></a>
<a class="el" href="classcolvars__gpu_1_1colvar__nvtx__prof.html">colvars_gpu::colvar_nvtx_prof</a>&#160;</td><td class="memItemRight" valign="bottom"><b>cvc_calc_total_force_prof</b></td></tr>
<tr class="separator:a12003a6c5b8d4561f64d39055e62faea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f303c3a4d60a79490f5df77870158ec"><td class="memItemLeft" align="right" valign="top"><a id="a4f303c3a4d60a79490f5df77870158ec" name="a4f303c3a4d60a79490f5df77870158ec"></a>
<a class="el" href="classcolvars__gpu_1_1colvar__nvtx__prof.html">colvars_gpu::colvar_nvtx_prof</a>&#160;</td><td class="memItemRight" valign="bottom"><b>cv_collect_cvc_data_prof</b></td></tr>
<tr class="separator:a4f303c3a4d60a79490f5df77870158ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a509a679ecc86285c66eecb73743740ba"><td class="memItemLeft" align="right" valign="top"><a id="a509a679ecc86285c66eecb73743740ba" name="a509a679ecc86285c66eecb73743740ba"></a>
<a class="el" href="classcolvars__gpu_1_1colvar__nvtx__prof.html">colvars_gpu::colvar_nvtx_prof</a>&#160;</td><td class="memItemRight" valign="bottom"><b>apply_forces_prof</b></td></tr>
<tr class="separator:a509a679ecc86285c66eecb73743740ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Class for managing the GPU calculation of CVCs. </p>
<dl class="section note"><dt>Note</dt><dd>This class is basically a GPU version of <a class="el" href="classcolvarmodule.html#ad52189d8b70cb2b1748536b41771dd38" title="Calculate collective variables.">colvarmodule::calc_colvars()</a>. In the future, the atom groups are supposed to be shared among CVCs, so instead of iterating over all colvars and computing them one by one, this class will flatten the colvardeps* tree, then compute all atom groups in one pass with CUDA graphs, then all CVCs, and finally collect the colvar values. </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aa1dad1c8031560f94be4a2ac2b9fd44a" name="aa1dad1c8031560f94be4a2ac2b9fd44a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1dad1c8031560f94be4a2ac2b9fd44a">&#9670;&#160;</a></span>apply_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int colvarmodule_gpu_calc::apply_forces </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>colvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcolvarmodule.html">colvarmodule</a> *&#160;</td>
          <td class="paramname"><em>colvar_module</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the forces to the atom groups from the CVCs. </p>
<p >On the first call, the CUDA graph for apply atom group forces will be constructed and instantiated. On subsequent calls, the existing CUDA graph will be launched.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">colvars</td><td>A vector of all colvar objects </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">colvar_module</td><td>The main colvarmodule object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>COLVARS_OK if succeeded </dd></dl>

</div>
</div>
<a id="a93755e061e215662783b8cb7ad9d70da" name="a93755e061e215662783b8cb7ad9d70da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93755e061e215662783b8cb7ad9d70da">&#9670;&#160;</a></span>calc_cvs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int colvarmodule_gpu_calc::calc_cvs </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classcolvar.html">colvar</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>colvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcolvarmodule.html">colvarmodule</a> *&#160;</td>
          <td class="paramname"><em>colvar_module</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the <code>colvar {...}</code> blocks. </p>
<p >This function performs the following operations:</p><ol type="1">
<li>Call <code>cv_update_flags</code> to update the flags of all colvars and cvcs</li>
<li>If the current step is greater than 0, call <code>cvc_calc_total_force</code> to calculate the total force on each CVC</li>
<li>Call <code>atom_group_read_data_gpu</code> to read the atom positions to GPU buffers and calculate the required properties</li>
<li>Call <code>cvc_calc_value</code> to calculate the values of all CVCs</li>
<li>Call <code>cvc_calc_gradients</code> to calculate the gradients of all CVCs</li>
<li>Call <code>atom_group_calc_fit_gradients</code> to calculate the fit gradients</li>
<li>Call <code>cvc_calc_Jacobian_derivative</code> to calculate the Jacobian derivatives of all CVCs</li>
<li>Call <code>cv_collect_cvc_data</code> to sum up the colvar values On the first call, the CUDA graphs will be constructed and instantiated. On subsequent calls, the existing CUDA graphs will be launched for "atom_group_read_data_gpu" and "atom_group_calc_fit_gradients".</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">colvars</td><td>A vector of all colvar objects </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">colvar_module</td><td>The main colvarmodule object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>COLVARS_OK if succeeded </dd></dl>

</div>
</div>
<a id="aeff40fbc0f5db83a6e0d700db064b164" name="aeff40fbc0f5db83a6e0d700db064b164"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeff40fbc0f5db83a6e0d700db064b164">&#9670;&#160;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int colvarmodule_gpu_calc::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize all the GPU compute graphs. </p>
<dl class="section return"><dt>Returns</dt><dd>COLVARS_OK if succeeded </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aa1597ec819e84ed6ed925e160f09c6e8" name="aa1597ec819e84ed6ed925e160f09c6e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1597ec819e84ed6ed925e160f09c6e8">&#9670;&#160;</a></span>forced_atom_groups</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classcolvardeps.html">colvardeps</a>*&gt; colvars_gpu::colvarmodule_gpu_calc::forced_atom_groups</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A list of atom groups that require forces to be applied. </p>
<dl class="section note"><dt>Note</dt><dd>I have no way to forward declare <a class="el" href="classcvm_1_1atom__group.html" title="Store the information of a group of atoms in a structure-of-arrays (SoA) style.">cvm::atom_group</a> here so I have to use colvardeps as a workaround. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="colvar__gpu__calc_8h_source.html">colvar_gpu_calc.h</a></li>
<li>colvar_gpu_calc.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Nov 26 2025 19:50:36 for Collective Variables Module - Developer Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
